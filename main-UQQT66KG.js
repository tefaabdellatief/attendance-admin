import{a as Ze}from"./chunk-WMZDVTJT.js";import{b as Je,c as Y,d as L,e as q,f as G,g as N,h as H,i as de,j as K,k as $,l as J,m as Qe,n as ce,o as Q,p as B,q as Z,r as X}from"./chunk-OVLE5S5M.js";import{a as A}from"./chunk-VRPC7EEM.js";import"./chunk-X5YLR3NI.js";import{$ as a,Aa as U,B as O,C as k,Ca as F,Da as je,E as De,Fa as Ue,G as h,Ga as Ye,Ha as se,Ia as qe,Ja as Ge,Ka as D,La as He,M as d,Ma as Ke,N as t,Na as $e,O as n,P as S,Q as Te,R as Fe,S as P,T as f,U as g,X as V,Z as E,aa as _,b as Pe,ba as v,ca as ue,da as y,ea as C,f as ae,fa as b,ha as Ve,i as oe,ja as x,ka as Re,la as w,m as Me,n as m,na as Le,o as p,oa as Ne,p as Se,pa as Be,q as Ee,s as Ae,v as ke,va as We,wa as R,x as le,xa as I,y as Ie,ya as ze,z as l,za as j}from"./chunk-JMF3YSV7.js";import{a as Oe,i as M}from"./chunk-ODN5LVDJ.js";var Xe=()=>{let o=Me(D);return Me(A).isLoggedIn()?!0:o.parseUrl("/login")};var ee=class o{loadingSubject=new Pe(!1);loading$=this.loadingSubject.asObservable();show(){this.loadingSubject.next(!0)}hide(){this.loadingSubject.next(!1)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=oe({token:o,factory:o.\u0275fac,providedIn:"root"})};var te=class o{STORAGE_KEY="app_flash_message";set(i,e="info"){try{let r={message:i,type:e};sessionStorage.setItem(this.STORAGE_KEY,JSON.stringify(r))}catch{}}consume(){try{let i=sessionStorage.getItem(this.STORAGE_KEY);return i?(sessionStorage.removeItem(this.STORAGE_KEY),JSON.parse(i)):null}catch{return null}}clear(){try{sessionStorage.removeItem(this.STORAGE_KEY)}catch{}}static \u0275fac=function(e){return new(e||o)};static \u0275prov=oe({token:o,factory:o.\u0275fac,providedIn:"root"})};function ot(o,i){if(o&1&&(t(0,"div",19),a(1),n()),o&2){let e=g();E("warning",e.flashType==="warning")("error",e.flashType==="error")("success",e.flashType==="success"),l(),v(" ",e.flashMessage," ")}}function lt(o,i){o&1&&S(0,"span",20)}function ut(o,i){if(o&1&&(t(0,"div",21),a(1),n()),o&2){let e=g();l(),_(e.error)}}var me=class o{constructor(i,e,r,u){this.router=i;this.sb=e;this.loadingService=r;this.flash=u}identifier="";passcode="";loading=!1;error="";flashMessage=null;flashType="info";ngOnInit(){let i=this.flash.consume();i?.message&&(this.flashMessage=i.message,this.flashType=i.type??"info")}submit(){return M(this,null,function*(){this.error="",this.loading=!0,this.loadingService.show();try{if(!(yield this.sb.login(this.identifier.trim(),this.passcode))){this.error="\u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0627\u0639\u062A\u0645\u0627\u062F \u063A\u064A\u0631 \u0635\u0627\u0644\u062D\u0629 \u0623\u0648 \u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645 \u063A\u064A\u0631 \u0646\u0634\u0637.";return}this.flash.clear(),this.router.navigateByUrl("/dashboard")}catch(i){this.error=i?.message??"\u0641\u0634\u0644 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u062E\u0648\u0644"}finally{this.loading=!1,this.loadingService.hide()}})}static \u0275fac=function(e){return new(e||o)(O(D),O(A),O(ee),O(te))};static \u0275cmp=k({type:o,selectors:[["app-login"]],decls:29,vars:7,consts:[["form","ngForm"],[1,"login-page"],["dir","rtl",1,"login-center"],[1,"info-col"],[1,"brand"],["src","favicon.ico","alt","\u0634\u0639\u0627\u0631 \u062F\u0642\u062F\u0642 \u0628\u0631\u062C\u0631",1,"logo"],[1,"login-container"],["class","flash",3,"warning","error","success",4,"ngIf"],[3,"ngSubmit"],[1,"form-group"],["for","identifier"],[1,"input-wrapper"],[1,"input-icon"],["name","identifier","id","identifier","placeholder","\u0623\u062F\u062E\u0644 \u0627\u0633\u0645 \u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645","autocomplete","username","required","",3,"ngModelChange","ngModel"],["for","passcode"],["name","passcode","id","passcode","type","password","placeholder","\u0623\u062F\u062E\u0644 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631","autocomplete","current-password","required","",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"],["class","spinner",4,"ngIf"],["class","error",4,"ngIf"],[1,"flash"],[1,"spinner"],[1,"error"]],template:function(e,r){if(e&1){let u=P();t(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),S(4,"img",5),n(),t(5,"div",6),h(6,ot,2,7,"div",7),t(7,"h2"),a(8,"\u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u062E\u0648\u0644"),n(),t(9,"form",8,0),f("ngSubmit",function(){return m(u),p(r.submit())}),t(11,"div",9)(12,"label",10),a(13,"\u0627\u0633\u0645 \u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645"),n(),t(14,"div",11)(15,"span",12),a(16,"\u{1F464}"),n(),t(17,"input",13),b("ngModelChange",function(s){return m(u),C(r.identifier,s)||(r.identifier=s),p(s)}),n()()(),t(18,"div",9)(19,"label",14),a(20,"\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"),n(),t(21,"div",11)(22,"span",12),a(23,"\u{1F512}"),n(),t(24,"input",15),b("ngModelChange",function(s){return m(u),C(r.passcode,s)||(r.passcode=s),p(s)}),n()()(),t(25,"button",16),h(26,lt,1,0,"span",17),a(27),n()(),h(28,ut,2,1,"div",18),n()()()()}if(e&2){let u=V(10);l(6),d("ngIf",r.flashMessage),l(11),y("ngModel",r.identifier),l(7),y("ngModel",r.passcode),l(),d("disabled",r.loading||!u.form.valid),l(),d("ngIf",r.loading),l(),v(" ",r.loading?"\u062C\u0627\u0631\u064A \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u062E\u0648\u0644...":"\u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u062E\u0648\u0644"," "),l(),d("ngIf",r.error)}},dependencies:[F,I,B,H,Y,L,q,Q,N,G],styles:['.login-page[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;background:#fff;background-image:linear-gradient(135deg,#f5f7fa,#c3cfe2)}@supports (min-height: 100dvh){.login-page[_ngcontent-%COMP%]{min-height:100dvh}}.login-page[_ngcontent-%COMP%]{padding-bottom:max(20px,env(safe-area-inset-bottom));padding-top:max(20px,env(safe-area-inset-top));padding-left:max(20px,env(safe-area-inset-left));padding-right:max(20px,env(safe-area-inset-right))}.login-center[_ngcontent-%COMP%]{width:100%;max-width:450px;display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_slideInUp .6s ease-out}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.info-col[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:32px;width:100%}.brand[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.brand[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{width:120px;height:120px;border-radius:20px;border:2px solid var(--color-primary);box-shadow:0 12px 32px #00000026;background:#fff;transition:all .3s ease}.brand[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 16px 40px #0003}.login-container[_ngcontent-%COMP%]{width:100%;padding:40px;border:1px solid rgba(255,255,255,.2);border-radius:20px;box-shadow:0 20px 60px #0000001a;background:#fffffff2;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);transition:all .3s ease;position:relative;overflow:hidden}.login-container[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,var(--color-primary),var(--color-primary-dark));border-radius:20px 20px 0 0}.login-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;margin-bottom:32px;color:var(--color-primary-dark);text-align:center;font-size:2rem;font-weight:700;letter-spacing:-.5px}.form-group[_ngcontent-%COMP%]{margin-bottom:24px}label[_ngcontent-%COMP%]{display:block;margin-bottom:10px;color:var(--color-primary-dark);font-weight:600;font-size:.95rem}.input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-icon[_ngcontent-%COMP%]{position:absolute;right:16px;font-size:18px;color:var(--muted-text);z-index:1}input[_ngcontent-%COMP%]{width:100%;padding:16px 50px 16px 20px;border:2px solid var(--border-color);border-radius:12px;font-size:1rem;transition:all .3s ease;background:#fff;box-shadow:0 2px 8px #0000000d}input[_ngcontent-%COMP%]:hover{border-color:var(--color-primary);box-shadow:0 4px 12px #f6b8191a}input[_ngcontent-%COMP%]:focus{border-color:var(--color-primary);box-shadow:0 0 0 4px #f6b81933;outline:none;transform:translateY(-1px)}input[_ngcontent-%COMP%]::placeholder{color:#999;font-weight:400}button[_ngcontent-%COMP%]{margin-top:32px;width:100%;padding:18px;border-radius:12px;border:none;background:linear-gradient(135deg,var(--color-primary),#f4a500);color:var(--color-primary-dark);font-weight:700;font-size:1.1rem;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 16px #f6b8194d;position:relative;overflow:hidden;min-height:48px}button[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}button[_ngcontent-%COMP%]:hover:before{left:100%}button[_ngcontent-%COMP%]:hover{filter:brightness(1.05);transform:translateY(-2px);box-shadow:0 8px 24px #f6b81966}button[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 4px 16px #f6b8194d}button[disabled][_ngcontent-%COMP%]{opacity:.7;cursor:not-allowed;transform:none;box-shadow:0 2px 8px #f6b81933}button[disabled][_ngcontent-%COMP%]:hover{transform:none;filter:none;box-shadow:0 2px 8px #f6b81933}.spinner[_ngcontent-%COMP%]{display:inline-block;width:20px;height:20px;border:3px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#fff;animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite;margin-left:8px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error[_ngcontent-%COMP%]{margin-top:20px;padding:16px;color:#d32f2f;background:linear-gradient(135deg,#d32f2f1a,#d32f2f0d);border:1px solid rgba(211,47,47,.2);border-radius:12px;text-align:center;font-weight:500;animation:_ngcontent-%COMP%_shake .5s ease-in-out}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}25%{transform:translate(-5px)}75%{transform:translate(5px)}}@media (max-width: 768px){.login-page[_ngcontent-%COMP%]{padding:16px}.login-center[_ngcontent-%COMP%]{max-width:420px}.login-container[_ngcontent-%COMP%]{padding:32px 24px;border-radius:16px;box-shadow:0 12px 36px #00000014}.login-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.75rem;margin-bottom:28px}.brand[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{width:100px;height:100px}input[_ngcontent-%COMP%]{padding:14px 45px 14px 18px;font-size:16px}button[_ngcontent-%COMP%]{padding:16px;font-size:1rem}}@media (max-width: 480px){.login-page[_ngcontent-%COMP%]{padding:12px}.login-container[_ngcontent-%COMP%]{padding:20px 16px;border-radius:14px;box-shadow:0 8px 24px #0000000f}.login-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.35rem;margin-bottom:20px}.brand[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{width:72px;height:72px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}input[_ngcontent-%COMP%]{padding:12px 40px 12px 14px;font-size:16px}button[_ngcontent-%COMP%]{padding:14px;font-size:.95rem;min-height:48px}}@media (max-width: 360px){.login-container[_ngcontent-%COMP%]{padding:16px 12px;border-radius:12px}.login-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;margin-bottom:16px}.brand[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{width:64px;height:64px}}@media (max-height: 480px) and (orientation: landscape){.login-page[_ngcontent-%COMP%]{align-items:flex-start}.login-center[_ngcontent-%COMP%]{margin-top:12px}.login-container[_ngcontent-%COMP%]{padding:16px 14px}.login-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:12px}.form-group[_ngcontent-%COMP%]{margin-bottom:14px}}.flash[_ngcontent-%COMP%]{margin-bottom:16px;padding:12px 14px;border-radius:10px;border:1px solid transparent;text-align:center;font-weight:600}.flash.warning[_ngcontent-%COMP%]{background:#fff7e6;border-color:#ffe58f;color:#ad6800}.flash.error[_ngcontent-%COMP%]{background:#fff1f0;border-color:#ffccc7;color:#a8071a}.flash.success[_ngcontent-%COMP%]{background:#f6ffed;border-color:#b7eb8f;color:#237804}']})};var st=()=>[];function dt(o,i){if(o&1){let e=P();t(0,"div",14),f("click",function(){let u=m(e).$implicit,c=g();return p(c.goToBranch(u))}),t(1,"div",15)(2,"div",16),a(3),n(),t(4,"div",17),a(5),n()(),t(6,"div",18)(7,"div",19),a(8),n(),t(9,"div",20),a(10,"\u0645\u0648\u0638\u0641\u0648\u0646 \u064A\u0639\u0645\u0644\u0648\u0646 \u0627\u0644\u064A\u0648\u0645"),n()(),t(11,"div",21)(12,"button",22),f("click",function(u){let c=m(e).$implicit;return g().goToBranch(c),p(u.stopPropagation())}),a(13,"\u0627\u0644\u0641\u0631\u0639"),n(),t(14,"button",23),f("click",function(u){let c=m(e).$implicit;return g().goToAttendance(c),p(u.stopPropagation())}),a(15,"\u0627\u0644\u062D\u0636\u0648\u0631"),n()()()}if(o&2){let e=i.$implicit,r=i.index,u=g();d("ngClass",u.gradientClass(r)),l(3),_(u.branchEmoji(r,e.branch_name)),l(2),_(e.employees_count),l(3),_(e.branch_name)}}function ct(o,i){o&1&&(t(0,"div",24),a(1,"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644..."),n())}function mt(o,i){if(o&1&&(t(0,"div",25),a(1),n()),o&2){let e=g();l(),_(e.error)}}var _e=class o{constructor(i,e){this.sb=i;this.router=e}stats=null;loading=!1;error="";ngOnInit(){return M(this,null,function*(){yield this.loadStats()})}loadStats(){return M(this,null,function*(){this.loading=!0,this.error="";try{let{data:i,error:e}=yield this.sb.rpc("get_dashboard_stats");if(e)throw e;let r=i;if(Array.isArray(i)){let u=i[0];r=u?.get_dashboard_stats??u??null}this.stats=r}catch(i){this.error=i?.message||"\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0644\u0648\u062D\u0629 \u0627\u0644\u062A\u062D\u0643\u0645"}finally{this.loading=!1}})}gradientClass(i){return`grad-${i%6}`}branchEmoji(i,e){let r=["\u{1F354}","\u{1F35F}","\u{1F32F}","\u{1F355}","\u{1F959}","\u{1F357}","\u{1F371}","\u{1F964}","\u{1F9C1}","\u2615","\u{1F96A}","\u{1F957}","\u{1F9C6}","\u{1F369}","\u{1F35C}"],u=Math.abs((e?.length||0)+i*7);return r[u%r.length]}goToBranch(i){this.router.navigate(["/branches"],{queryParams:{branchId:i.branch_id,q:i.branch_name}})}goToAttendance(i){let e=new Date,r=e.getFullYear(),u=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0"),s=`${r}-${u}-${c}`;this.router.navigate(["/attendance-records"],{queryParams:{branchId:i.branch_id,date:s}})}static \u0275fac=function(e){return new(e||o)(O(A),O(D))};static \u0275cmp=k({type:o,selectors:[["app-dashboard"]],decls:42,vars:14,consts:[[1,"cards"],[1,"card","primary"],[1,"card-icon"],[1,"card-content"],[1,"title"],[1,"value"],[1,"card","info"],[1,"card","success"],[1,"card","danger"],[1,"panel"],[1,"branch-cards"],["class","branch-card",3,"ngClass","click",4,"ngFor","ngForOf"],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],[1,"branch-card",3,"click","ngClass"],[1,"branch-card__header"],[1,"branch-card__icon"],["title","\u0639\u062F\u062F \u0627\u0644\u0645\u0648\u0638\u0641\u064A\u0646 \u0627\u0644\u064A\u0648\u0645",1,"branch-card__badge"],[1,"branch-card__content"],[1,"branch-card__title"],[1,"branch-card__subtitle"],[1,"branch-card__actions"],["title","\u0641\u062A\u062D \u0627\u0644\u0641\u0631\u0639",1,"action-btn",3,"click"],["title","\u0633\u062C\u0644\u0627\u062A \u0627\u0644\u062D\u0636\u0648\u0631",1,"action-btn","outline",3,"click"],[1,"loading"],[1,"error"]],template:function(e,r){e&1&&(t(0,"section",0)(1,"div",1)(2,"div",2),a(3,"\u{1F9D1}\u200D\u{1F373}"),n(),t(4,"div",3)(5,"div",4),a(6,"\u0627\u0644\u0645\u0648\u0638\u0641\u0648\u0646 \u0627\u0644\u0639\u0627\u0645\u0644\u0648\u0646 \u0627\u0644\u064A\u0648\u0645"),n(),t(7,"div",5),a(8),n()()(),t(9,"div",6)(10,"div",2),a(11,"\u{1F7E2}"),n(),t(12,"div",3)(13,"div",4),a(14,"\u064A\u0639\u0645\u0644\u0648\u0646 \u0627\u0644\u0622\u0646"),n(),t(15,"div",5),a(16),n()()(),t(17,"div",7)(18,"div",2),a(19,"\u{1F4B0}"),n(),t(20,"div",3)(21,"div",4),a(22,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0645\u0643\u0627\u0641\u0622\u062A \u0627\u0644\u064A\u0648\u0645"),n(),t(23,"div",5),a(24),x(25,"number"),n()()(),t(26,"div",8)(27,"div",2),a(28,"\u{1F4B8}"),n(),t(29,"div",3)(30,"div",4),a(31,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u062E\u0635\u0648\u0645\u0627\u062A \u0627\u0644\u064A\u0648\u0645"),n(),t(32,"div",5),a(33),x(34,"number"),n()()()(),t(35,"section",9)(36,"h3"),a(37,"\u0639\u062F\u062F \u0627\u0644\u0645\u0648\u0638\u0641\u064A\u0646 \u0644\u0643\u0644 \u0641\u0631\u0639 \u0627\u0644\u064A\u0648\u0645"),n(),t(38,"div",10),h(39,dt,16,4,"div",11),n()(),h(40,ct,2,0,"div",12)(41,mt,2,1,"div",13)),e&2&&(l(8),_((r.stats==null?null:r.stats.employees_worked_today)??0),l(8),_((r.stats==null?null:r.stats.currently_working)??0),l(8),_(w(25,7,r.stats==null?null:r.stats.additions_today,"1.2-2")),l(9),_(w(34,10,r.stats==null?null:r.stats.deductions_today,"1.2-2")),l(6),d("ngForOf",(r.stats==null?null:r.stats.employees_per_branch_today)||Ve(13,st)),l(),d("ngIf",r.loading),l(),d("ngIf",r.error))},dependencies:[F,We,R,I,U],styles:['.cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:24px;margin-bottom:24px}.card[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center;padding:20px;border-radius:14px;color:#fff}.card[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{font-size:40px;line-height:1}.card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#fff;opacity:.95;font-size:14px;font-weight:600}.card[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:34px;font-weight:800}.card.primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4e54c8,#8f94fb)}.card.info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#36d1dc,#5b86e5)}.card.success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#11998e,#38ef7d)}.card.danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#cb356b,#bd3f32)}.panel[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;box-shadow:0 4px 12px #0000000f}.panel[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;color:#333}.branch-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px}.branch-card[_ngcontent-%COMP%]{position:relative;border-radius:14px;padding:16px;color:#fff;overflow:hidden;box-shadow:0 8px 20px #0000001f;transform:translateY(0);transition:transform .2s ease,box-shadow .2s ease;isolation:isolate}.branch-card[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:radial-gradient(120px 120px at 85% -10%,rgba(255,255,255,.35),transparent 60%);pointer-events:none;z-index:0}.branch-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 12px 28px #0000002e}.branch-card__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;position:relative;z-index:1}.branch-card__icon[_ngcontent-%COMP%]{font-size:28px;line-height:1}.branch-card__badge[_ngcontent-%COMP%]{background:#ffffff40;border:1px solid rgba(255,255,255,.35);border-radius:999px;padding:4px 10px;font-weight:700}.branch-card__content[_ngcontent-%COMP%]{position:relative;z-index:1}.branch-card__title[_ngcontent-%COMP%]{font-size:18px;font-weight:800;margin-bottom:2px}.branch-card__subtitle[_ngcontent-%COMP%]{font-size:12px;opacity:.9}.branch-card__actions[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:12px;position:relative;z-index:1}.action-btn[_ngcontent-%COMP%]{appearance:none;border:0;cursor:pointer;background:#ffffffe6;color:#333;padding:6px 10px;border-radius:10px;font-weight:700;font-size:12px;transition:transform .15s ease,background .15s ease}.action-btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);background:#fff}.action-btn.outline[_ngcontent-%COMP%]{background:transparent;color:#fff;border:1px solid rgba(255,255,255,.7)}.grad-0[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4e54c8,#8f94fb)}.grad-1[_ngcontent-%COMP%]{background:linear-gradient(135deg,#36d1dc,#5b86e5)}.grad-2[_ngcontent-%COMP%]{background:linear-gradient(135deg,#11998e,#38ef7d)}.grad-3[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff512f,#dd2476)}.grad-4[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f7971e,#ffd200)}.grad-5[_ngcontent-%COMP%]{background:linear-gradient(135deg,#833ab4,#fd1d1d)}.loading[_ngcontent-%COMP%]{margin-top:8px;color:#555}.error[_ngcontent-%COMP%]{margin-top:8px;color:#b00020}']})};function pt(o,i){if(o&1&&(t(0,"option",68),a(1),n()),o&2){let e=i.$implicit;d("ngValue",e.id),l(),_(e.full_name||e.username)}}function gt(o,i){if(o&1&&(t(0,"option",68),a(1),n()),o&2){let e=i.$implicit;d("ngValue",e.id),l(),_(e.full_name||e.username)}}function _t(o,i){if(o&1&&(t(0,"option",68),a(1),n()),o&2){let e=i.$implicit;d("ngValue",e.id),l(),_(e.name)}}function ft(o,i){if(o&1&&(t(0,"option",68),a(1),n()),o&2){let e=i.$implicit;d("ngValue",e.id),l(),_(e.name)}}function ht(o,i){if(o&1&&(t(0,"p",69)(1,"span"),a(2,"\u26A0\uFE0F"),n(),a(3),n()),o&2){let e=g();l(3),v(" ",e.formError," ")}}function yt(o,i){if(o&1){let e=P();t(0,"div",70)(1,"div",71)(2,"app-button",72),f("click",function(){m(e);let u=g();return p(u.closeModal())}),a(3,"\u0625\u0644\u063A\u0627\u0621"),n(),t(4,"app-button",73),f("click",function(){m(e);let u=g();return p(u.requestSave())}),a(5),n()(),t(6,"p",74),a(7,"\u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0642\u0648\u0644 \u0627\u0644\u0645\u0645\u064A\u0632\u0629 \u0628\u0639\u0644\u0627\u0645\u0629 (*) \u0625\u0644\u0632\u0627\u0645\u064A\u0629"),n()()}if(o&2){let e=g(),r=V(35);l(2),d("disabled",e.saving),l(2),d("disabled",e.saving||!r.form.valid),l(),_(e.editMode?"\u062D\u0641\u0638 \u0627\u0644\u062A\u063A\u064A\u064A\u0631\u0627\u062A":"\u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0633\u062C\u0644")}}function Ct(o,i){if(o&1){let e=P();t(0,"div",70)(1,"div",75)(2,"p"),a(3),n(),t(4,"div",71)(5,"app-button",72),f("click",function(){m(e);let u=g();return p(u.confirm=!1)}),a(6,"\u0631\u062C\u0648\u0639"),n(),t(7,"app-button",73),f("click",function(){m(e);let u=g();return p(u.onConfirmSave())}),a(8),n()()()()}if(o&2){let e=g(),r=V(35);l(3),ue("\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 ",e.editMode?"\u062A\u062D\u062F\u064A\u062B":"\u0625\u0646\u0634\u0627\u0621",' \u0627\u0644\u0633\u062C\u0644 \u0644\u0644\u0645\u0633\u062A\u062E\u062F\u0645 "',e.userName(e.form.user_id),'"\u061F'),l(2),d("disabled",e.saving),l(2),d("disabled",e.saving||!r.form.valid),l(),_(e.saving?"\u062C\u0627\u0631\u064A \u0627\u0644\u062D\u0641\u0638...":"\u062A\u0623\u0643\u064A\u062F")}}function bt(o,i){o&1&&(t(0,"p"),a(1,"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644..."),n())}function vt(o,i){if(o&1&&(t(0,"p",76),a(1),n()),o&2){let e=g();l(),_(e.error)}}function xt(o,i){o&1&&(t(0,"div",77),a(1,"\u0627\u0644\u0631\u062C\u0627\u0621 \u0627\u062E\u062A\u064A\u0627\u0631 \u0645\u0633\u062A\u062E\u062F\u0645 \u0644\u0639\u0631\u0636 \u0633\u062C\u0644\u0627\u062A \u0627\u0644\u0634\u0647\u0631."),n())}function Mt(o,i){if(o&1&&S(0,"img",90),o&2){let e=g().ngIf;d("src",e,le)}}function wt(o,i){o&1&&(t(0,"span",91),a(1,"\u0641\u062A\u062D \u0627\u0644\u0635\u0648\u0631\u0629"),n())}function Ot(o,i){if(o&1&&(Te(0),t(1,"a",87),h(2,Mt,1,1,"img",88)(3,wt,2,0,"span",89),n(),Fe()),o&2){let e=i.ngIf,r=g(3);l(),d("href",e,le),l(),d("ngIf",r.showThumbnails),l(),d("ngIf",!r.showThumbnails)}}function Pt(o,i){o&1&&a(0,"-")}function St(o,i){if(o&1&&(t(0,"a",92),a(1," \u062E\u0631\u064A\u0637\u0629 "),n()),o&2){let e=g().$implicit,r=g(2);d("href",r.mapUrl(e.latitude,e.longitude),le)}}function Et(o,i){if(o&1){let e=P();t(0,"tr")(1,"td"),a(2),n(),t(3,"td"),a(4),n(),t(5,"td"),a(6),n(),t(7,"td"),a(8),x(9,"date"),n(),t(10,"td"),h(11,Ot,4,3,"ng-container",81)(12,Pt,1,0,"ng-template",null,1,Le),n(),t(14,"td"),a(15),n(),t(16,"td"),a(17),h(18,St,2,1,"a",82),n(),t(19,"td"),a(20),n(),t(21,"td"),a(22),n(),t(23,"td"),a(24),n(),t(25,"td"),a(26),n(),t(27,"td"),a(28),n(),t(29,"td"),a(30),n(),t(31,"td",83)(32,"div",71)(33,"app-button",84),f("btnClick",function(){let u=m(e).$implicit,c=g(2);return p(c.startEdit(u))}),t(34,"span",85),a(35,"\u270F\uFE0F"),n(),a(36," \u062A\u0639\u062F\u064A\u0644 "),n(),t(37,"app-button",86),f("btnClick",function(){let u=m(e).$implicit,c=g(2);return p(c.openDeleteModal(u))}),t(38,"span",85),a(39,"\u{1F5D1}\uFE0F"),n(),a(40," \u062D\u0630\u0641 "),n()()()()}if(o&2){let e=i.$implicit,r=V(13),u=g(2);l(2),_(u.userName(e.user_id)),l(2),_(e.branch_name||u.branchName(e.branch_id)),l(2),_(e.attendance_type||u.typeName(e.attendance_type_id)),l(2),_(w(9,17,e.recorded_at,"short")),l(3),d("ngIf",u.imageSrc(e.image_url))("ngIfElse",r),l(4),v(" ",e.latitude??"-"," "),l(2),v(" ",e.longitude??"-"," "),l(),d("ngIf",e.latitude!=null&&e.longitude!=null),l(2),_(e.worked_minutes??"-"),l(2),_(e.is_late?"\u2713":"\u2014"),l(2),_(e.is_early_leave?"\u2713":"\u2014"),l(2),_(e.is_auto?"\u2713":"\u2014"),l(2),_(e.notes||"-"),l(2),_(e.absence_reason||"-"),l(3),d("disabled",u.saving),l(4),d("disabled",u.saving)}}function At(o,i){if(o&1&&(t(0,"div",78)(1,"table",79)(2,"thead")(3,"tr")(4,"th"),a(5,"\u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645"),n(),t(6,"th"),a(7,"\u0627\u0644\u0641\u0631\u0639"),n(),t(8,"th"),a(9,"\u0627\u0644\u0646\u0648\u0639"),n(),t(10,"th"),a(11,"\u0648\u0642\u062A \u0627\u0644\u062A\u0633\u062C\u064A\u0644"),n(),t(12,"th"),a(13,"\u0627\u0644\u0635\u0648\u0631\u0629"),n(),t(14,"th"),a(15,"\u062E\u0637 \u0627\u0644\u0639\u0631\u0636"),n(),t(16,"th"),a(17,"\u062E\u0637 \u0627\u0644\u0637\u0648\u0644"),n(),t(18,"th"),a(19,"\u062F\u0642\u0627\u0626\u0642 \u0627\u0644\u0639\u0645\u0644"),n(),t(20,"th"),a(21,"\u0645\u062A\u0623\u062E\u0631"),n(),t(22,"th"),a(23,"\u0627\u0646\u0635\u0631\u0627\u0641 \u0645\u0628\u0643\u0631"),n(),t(24,"th"),a(25,"\u062A\u0644\u0642\u0627\u0626\u064A"),n(),t(26,"th"),a(27,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A"),n(),t(28,"th"),a(29,"\u0633\u0628\u0628 \u0627\u0644\u063A\u064A\u0627\u0628"),n(),t(30,"th"),a(31,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),n()()(),t(32,"tbody"),h(33,Et,41,20,"tr",80),n()()()),o&2){let e=g();l(33),d("ngForOf",e.filteredItems)}}function kt(o,i){o&1&&(t(0,"p"),a(1,"\u0644\u0627 \u064A\u0648\u062C\u062F \u0633\u062C\u0644\u0627\u062A."),n())}var fe=class o{constructor(i,e,r){this.sb=i;this.route=e;this.router=r}users=[];branches=[];types=[];items=[];filteredItems=[];searchQuery="";loading=!1;saving=!1;error="";formError="";selectedUserId=null;selectedMonth="";serverFiltered=!1;showThumbnails=!0;editMode=!1;editingId=null;form={user_id:null,branch_id:null,attendance_type_id:null,recorded_at:"",image_url:"",latitude:null,longitude:null,worked_minutes:null,is_late:!1,is_early_leave:!1,is_auto:!1,notes:"",absence_reason:""};modalOpen=!1;confirm=!1;showDeleteModal=!1;typeToDelete=null;ngOnInit(){return M(this,null,function*(){let i=new Date,e=i.getFullYear(),r=String(i.getMonth()+1).padStart(2,"0");this.selectedMonth=`${e}-${r}`;let u=this.route.snapshot.queryParamMap,c=u.get("userId"),s=u.get("month");s&&/^\d{4}-\d{2}$/.test(s)&&(this.selectedMonth=s),c&&(this.selectedUserId=c),yield Promise.all([this.loadUsers(),this.loadBranches(),this.loadTypes()]),yield this.reload()})}loadUsers(){return M(this,null,function*(){let{data:i}=yield this.sb.rpc("users_get");this.users=i||[]})}loadBranches(){return M(this,null,function*(){let{data:i}=yield this.sb.rpc("branches_get");this.branches=i||[]})}loadTypes(){return M(this,null,function*(){let{data:i}=yield this.sb.rpc("attendance_types_get");this.types=i||[]})}filterRecords(){this.applyFilters()}clearSearch(){this.searchQuery="",this.applyFilters()}reload(){return M(this,null,function*(){this.loading=!0;try{if(!this.selectedUserId){this.serverFiltered=!1,this.items=[],this.filteredItems=[];return}let[i,e]=(this.selectedMonth||"").split("-"),r=Number(i),u=Number(e),{data:c,error:s}=yield this.sb.rpc("get_monthly_attendance_records",{p_user_id:this.selectedUserId,p_year:r,p_month:u});if(s)throw s;this.items=Array.isArray(c)?c:[],this.serverFiltered=!0,this.applyFilters()}catch(i){this.error=i?.message??"\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0633\u062C\u0644\u0627\u062A \u0627\u0644\u062D\u0636\u0648\u0631"}finally{this.loading=!1}})}applyFilters(){if(!this.selectedUserId){this.filteredItems=[];return}let i=(this.searchQuery||"").toLowerCase();if(this.serverFiltered){if(!i){this.filteredItems=[...this.items];return}this.filteredItems=this.items.filter(T=>{let ne=this.userName(T.user_id).toLowerCase(),ve=(T.branch_name||this.branchName(T.branch_id)).toLowerCase(),xe=(T.attendance_type||this.typeName(T.attendance_type_id)).toLowerCase();return ne.includes(i)||ve.includes(i)||xe.includes(i)});return}let[e,r]=(this.selectedMonth||"").split("-"),u=Number(e),c=Number(r),s=new Date(u,c-1,1,0,0,0),z=new Date(u,c,0,23,59,59,999);this.filteredItems=this.items.filter(T=>{if(T.user_id!==this.selectedUserId)return!1;let ne=new Date(T.recorded_at);if(Number.isNaN(ne.getTime())||ne<s||ne>z)return!1;if(!i)return!0;let ve=this.userName(T.user_id).toLowerCase(),xe=this.branchName(T.branch_id).toLowerCase(),at=this.typeName(T.attendance_type_id).toLowerCase();return ve.includes(i)||xe.includes(i)||at.includes(i)})}onUserChange(i){return M(this,null,function*(){yield this.reload()})}onMonthChange(i){return M(this,null,function*(){yield this.reload()})}userName(i){return this.users.find(e=>e.id===i)?.full_name||this.users.find(e=>e.id===i)?.username||i}branchName(i){return this.branches.find(e=>e.id===i)?.name||i}typeName(i){return this.types.find(e=>e.id===i)?.name||i}resetForm(){this.editMode=!1,this.editingId=null,this.form={user_id:null,branch_id:null,attendance_type_id:null,recorded_at:"",image_url:"",latitude:null,longitude:null,worked_minutes:null,is_late:!1,is_early_leave:!1,is_auto:!1,notes:"",absence_reason:""},this.formError="",this.confirm=!1}startEdit(i){this.editMode=!0,this.editingId=i.id;let e=r=>r?r.substring(0,16):"";this.form={user_id:i.user_id,branch_id:i.branch_id,attendance_type_id:i.attendance_type_id,recorded_at:e(i.recorded_at),image_url:i.image_url||"",latitude:i.latitude??null,longitude:i.longitude??null,worked_minutes:i.worked_minutes??null,is_late:!!i.is_late,is_early_leave:!!i.is_early_leave,is_auto:!!i.is_auto,notes:i.notes||"",absence_reason:i.absence_reason||""},this.formError="",window.scrollTo({top:0,behavior:"smooth"}),this.confirm=!1,this.modalOpen=!0}submitForm(){return M(this,null,function*(){this.formError="",this.saving=!0;try{let i=c=>c?new Date(c).toISOString():null,e=c=>c!==null&&c!==""?Number(c):null,r=c=>c!==null&&c!==""?parseInt(c,10):null,u={user_id:this.form.user_id,branch_id:this.form.branch_id,attendance_type_id:this.form.attendance_type_id,recorded_at:i(this.form.recorded_at)||new Date().toISOString(),image_url:this.form.image_url||null,latitude:e(this.form.latitude),longitude:e(this.form.longitude),worked_minutes:r(this.form.worked_minutes),is_late:!!this.form.is_late,is_early_leave:!!this.form.is_early_leave,is_auto:!!this.form.is_auto,notes:this.form.notes||null,absence_reason:(this.form.absence_reason||"").trim()||null};if(this.editMode&&this.editingId){let{error:c}=yield this.sb.rpc("attendance_records_update",Oe({_id:this.editingId},u));if(c)throw c}else{let{error:c}=yield this.sb.rpc("attendance_records_insert",u);if(c)throw c}yield this.reload(),this.resetForm(),this.closeModal()}catch(i){this.formError=i?.message??"\u0641\u0634\u0644 \u062D\u0641\u0638 \u0627\u0644\u0633\u062C\u0644"}finally{this.saving=!1}})}openCreate(){this.resetForm(),this.editMode=!1,this.modalOpen=!0}closeModal(){this.modalOpen=!1,this.confirm=!1}requestSave(){this.formError="",this.confirm=!0}onConfirmSave(){return M(this,null,function*(){yield this.submitForm()})}onOverlayClick(i){let e=i.target;e&&e.classList.contains("modal-overlay")&&(this.confirm?this.confirm=!1:this.closeModal())}handleKeydown(i){i.key==="Escape"&&this.modalOpen&&(i.preventDefault(),this.confirm?this.confirm=!1:this.closeModal())}openDeleteModal(i){this.typeToDelete=i,this.showDeleteModal=!0}closeDeleteModal(){this.showDeleteModal=!1,this.typeToDelete=null}onDeleteOverlayClick(i){i.target?.classList?.contains("modal-overlay")&&this.closeDeleteModal()}onConfirmDelete(){return M(this,null,function*(){if(this.typeToDelete){this.saving=!0;try{let{error:i}=yield this.sb.rpc("attendance_records_delete",{_id:this.typeToDelete.id});if(i)throw i;yield this.reload(),this.closeDeleteModal()}catch(i){let e=i?.message||"",r=i?.code==="23503"||/foreign key|violates foreign key constraint/i.test(e);this.error=r?"\u062A\u0639\u0630\u0631 \u062D\u0630\u0641 \u0627\u0644\u0633\u062C\u0644 \u0644\u0648\u062C\u0648\u062F \u0633\u062C\u0644\u0627\u062A \u0645\u0631\u062A\u0628\u0637\u0629 \u0628\u0647. \u064A\u0631\u062C\u0649 \u0627\u0644\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0639\u0644\u0627\u0642\u0627\u062A \u0627\u0644\u0645\u0631\u062A\u0628\u0637\u0629 \u0623\u0648\u0644\u0627\u064B.":e||"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062D\u0630\u0641 \u0627\u0644\u0633\u062C\u0644"}finally{this.saving=!1}}})}imageSrc(i){if(!i)return"";let e=i.trim();return e?e.startsWith("data:image/")||e.startsWith("http://")||e.startsWith("https://")?e:/^[A-Za-z0-9+/=]+$/.test(e)?`data:image/jpeg;base64,${e}`:"":""}mapUrl(i,e){if(i==null||e==null)return"";let r=`${i},${e}`;return`https://www.google.com/maps?q=${encodeURIComponent(r)}`}static \u0275fac=function(e){return new(e||o)(O(A),O(qe),O(D))};static \u0275cmp=k({type:o,selectors:[["app-attendance-records"]],hostBindings:function(e,r){e&1&&f("keydown",function(c){return r.handleKeydown(c)},Ie)},decls:133,vars:58,consts:[["f","ngForm"],["noimg",""],[1,"actions-bar"],[1,"search-section"],["placeholder","\u0627\u0644\u0628\u062D\u062B \u0628\u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645 \u0623\u0648 \u0627\u0644\u0641\u0631\u0639 \u0623\u0648 \u0627\u0644\u0646\u0648\u0639...",3,"ngModelChange","search","clear","ngModel"],[1,"actions-section"],["variant","primary",3,"btnClick"],[1,"filters-bar"],[1,"filter-item"],["for","filterUser"],["id","filterUser",3,"ngModelChange","ngModel"],["disabled","",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["for","filterMonth"],["id","filterMonth","type","month",3,"ngModelChange","ngModel"],[1,"filter-item","toggle-thumb"],[1,"checkbox-inline"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"modal-overlay",3,"click"],[1,"modal","user-modal"],[1,"modal-header"],["aria-label","\u0625\u063A\u0644\u0627\u0642",1,"close-btn",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"ngSubmit"],[1,"form-grid"],[1,"form-group"],["for","user"],["id","user","name","user_id","required","",3,"ngModelChange","ngModel","disabled"],["for","branch"],["id","branch","name","branch_id","required","",3,"ngModelChange","ngModel","disabled"],["for","type"],["id","type","name","attendance_type_id","required","",3,"ngModelChange","ngModel","disabled"],["for","recorded_at"],["id","recorded_at","name","recorded_at","type","datetime-local","required","",3,"ngModelChange","ngModel","disabled"],["for","image_url"],["id","image_url","name","image_url",3,"ngModelChange","ngModel","disabled"],["for","latitude"],["id","latitude","name","latitude","type","number","step","any",3,"ngModelChange","ngModel","disabled"],["for","longitude"],["id","longitude","name","longitude","type","number","step","any",3,"ngModelChange","ngModel","disabled"],["for","worked_minutes"],["id","worked_minutes","name","worked_minutes","type","number","min","0","step","1",3,"ngModelChange","ngModel","disabled"],[1,"checkbox"],["name","is_late","type","checkbox",3,"ngModelChange","ngModel","disabled"],["name","is_early_leave","type","checkbox",3,"ngModelChange","ngModel","disabled"],["name","is_auto","type","checkbox",3,"ngModelChange","ngModel","disabled"],[1,"form-group","full-width"],["for","notes"],["id","notes","name","notes",3,"ngModelChange","ngModel","disabled"],["for","absence_reason"],["id","absence_reason","name","absence_reason",3,"ngModelChange","ngModel","disabled"],["class","error-message",4,"ngIf"],["class","modal-footer-actions",4,"ngIf"],[1,"modal","delete-modal"],[1,"delete-warning"],[1,"warning-icon"],["xmlns","http://www.w3.org/2000/svg","width","48","height","48","viewBox","0 0 24 24","fill","none","stroke","#f59e0b","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","12","r","10"],["x1","12","y1","8","x2","12","y2","12"],["x1","12","y1","16","x2","12.01","y2","16"],[1,"delete-actions"],["variant","danger",3,"click","disabled"],["variant","outline",3,"click","disabled"],[4,"ngIf"],["class","error",4,"ngIf"],["class","hint-select-user",4,"ngIf"],["class","table-container",4,"ngIf"],[3,"ngValue"],[1,"error-message"],[1,"modal-footer-actions"],[1,"action-buttons"],["type","button","variant","outline",3,"click","disabled"],["type","button","variant","primary",3,"click","disabled"],[1,"hint-text"],[1,"confirmation-message"],[1,"error"],[1,"hint-select-user"],[1,"table-container"],[1,"app-table"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["class","map-link","target","_blank","rel","noopener","title","\u0641\u062A\u062D \u0627\u0644\u0645\u0648\u0642\u0639 \u0639\u0644\u0649 \u0627\u0644\u062E\u0631\u0627\u0626\u0637",3,"href",4,"ngIf"],[1,"actions"],["variant","outline","size","sm",3,"btnClick","disabled"],[1,"btn-icon"],["variant","danger","size","sm",3,"btnClick","disabled"],["target","_blank","rel","noopener","title","\u0641\u062A\u062D \u0627\u0644\u0635\u0648\u0631\u0629 \u0641\u064A \u062A\u0628\u0648\u064A\u0628 \u062C\u062F\u064A\u062F",1,"img-link",3,"href"],["alt","thumb","class","thumb",3,"src",4,"ngIf"],["class","open-img-text",4,"ngIf"],["alt","thumb",1,"thumb",3,"src"],[1,"open-img-text"],["target","_blank","rel","noopener","title","\u0641\u062A\u062D \u0627\u0644\u0645\u0648\u0642\u0639 \u0639\u0644\u0649 \u0627\u0644\u062E\u0631\u0627\u0626\u0637",1,"map-link",3,"href"]],template:function(e,r){if(e&1){let u=P();t(0,"h2"),a(1,"\u0633\u062C\u0644\u0627\u062A \u0627\u0644\u062D\u0636\u0648\u0631"),n(),t(2,"div",2)(3,"div",3)(4,"app-enhanced-search",4),b("ngModelChange",function(s){return m(u),C(r.searchQuery,s)||(r.searchQuery=s),p(s)}),f("search",function(){return m(u),p(r.filterRecords())})("clear",function(){return m(u),p(r.clearSearch())}),n()(),t(5,"div",5)(6,"app-button",6),f("btnClick",function(){return m(u),p(r.openCreate())}),a(7,"\u2795 \u0633\u062C\u0644 \u062C\u062F\u064A\u062F"),n()()(),t(8,"div",7)(9,"div",8)(10,"label",9),a(11,"\u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645"),n(),t(12,"select",10),b("ngModelChange",function(s){return m(u),C(r.selectedUserId,s)||(r.selectedUserId=s),p(s)}),f("ngModelChange",function(s){return m(u),p(r.onUserChange(s))}),t(13,"option",11),a(14,"\u0627\u062E\u062A\u0631 \u0645\u0633\u062A\u062E\u062F\u0645\u064B\u0627"),n(),h(15,pt,2,2,"option",12),n()(),t(16,"div",8)(17,"label",13),a(18,"\u0627\u0644\u0634\u0647\u0631"),n(),t(19,"input",14),b("ngModelChange",function(s){return m(u),C(r.selectedMonth,s)||(r.selectedMonth=s),p(s)}),f("ngModelChange",function(s){return m(u),p(r.onMonthChange(s))}),n()(),t(20,"div",15)(21,"label",16)(22,"input",17),b("ngModelChange",function(s){return m(u),C(r.showThumbnails,s)||(r.showThumbnails=s),p(s)}),n(),t(23,"span"),a(24,"\u0639\u0631\u0636 \u0627\u0644\u0635\u0648\u0631 \u0627\u0644\u0645\u0635\u063A\u0631\u0629"),n()()()(),t(25,"div",18),f("click",function(s){return m(u),p(r.onOverlayClick(s))}),t(26,"div",19)(27,"div",20)(28,"h3"),a(29),n(),t(30,"button",21),f("click",function(){return m(u),p(r.closeModal())}),t(31,"span",22),a(32,"\xD7"),n()()(),t(33,"div",23)(34,"form",24,0),f("ngSubmit",function(){return m(u),p(r.confirm?r.onConfirmSave():r.requestSave())}),t(36,"div",25)(37,"div",26)(38,"label",27),a(39,"\u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645 *"),n(),t(40,"select",28),b("ngModelChange",function(s){return m(u),C(r.form.user_id,s)||(r.form.user_id=s),p(s)}),t(41,"option",11),a(42,"\u0627\u062E\u062A\u0631 \u0645\u0633\u062A\u062E\u062F\u0645\u064B\u0627"),n(),h(43,gt,2,2,"option",12),n()(),t(44,"div",26)(45,"label",29),a(46,"\u0627\u0644\u0641\u0631\u0639 *"),n(),t(47,"select",30),b("ngModelChange",function(s){return m(u),C(r.form.branch_id,s)||(r.form.branch_id=s),p(s)}),t(48,"option",11),a(49,"\u0627\u062E\u062A\u0631 \u0641\u0631\u0639\u064B\u0627"),n(),h(50,_t,2,2,"option",12),n()(),t(51,"div",26)(52,"label",31),a(53,"\u0646\u0648\u0639 \u0627\u0644\u062D\u0636\u0648\u0631 *"),n(),t(54,"select",32),b("ngModelChange",function(s){return m(u),C(r.form.attendance_type_id,s)||(r.form.attendance_type_id=s),p(s)}),t(55,"option",11),a(56,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0646\u0648\u0639"),n(),h(57,ft,2,2,"option",12),n()(),t(58,"div",26)(59,"label",33),a(60,"\u0648\u0642\u062A \u0627\u0644\u062A\u0633\u062C\u064A\u0644 *"),n(),t(61,"input",34),b("ngModelChange",function(s){return m(u),C(r.form.recorded_at,s)||(r.form.recorded_at=s),p(s)}),n()(),t(62,"div",26)(63,"label",35),a(64,"\u0631\u0627\u0628\u0637 \u0627\u0644\u0635\u0648\u0631\u0629"),n(),t(65,"input",36),b("ngModelChange",function(s){return m(u),C(r.form.image_url,s)||(r.form.image_url=s),p(s)}),n()(),t(66,"div",26)(67,"label",37),a(68,"\u062E\u0637 \u0627\u0644\u0639\u0631\u0636"),n(),t(69,"input",38),b("ngModelChange",function(s){return m(u),C(r.form.latitude,s)||(r.form.latitude=s),p(s)}),n()(),t(70,"div",26)(71,"label",39),a(72,"\u062E\u0637 \u0627\u0644\u0637\u0648\u0644"),n(),t(73,"input",40),b("ngModelChange",function(s){return m(u),C(r.form.longitude,s)||(r.form.longitude=s),p(s)}),n()(),t(74,"div",26)(75,"label",41),a(76,"\u062F\u0642\u0627\u0626\u0642 \u0627\u0644\u0639\u0645\u0644"),n(),t(77,"input",42),b("ngModelChange",function(s){return m(u),C(r.form.worked_minutes,s)||(r.form.worked_minutes=s),p(s)}),n()(),t(78,"div",26)(79,"label",43)(80,"input",44),b("ngModelChange",function(s){return m(u),C(r.form.is_late,s)||(r.form.is_late=s),p(s)}),n(),t(81,"span"),a(82,"\u0645\u062A\u0623\u062E\u0631\u061F"),n()()(),t(83,"div",26)(84,"label",43)(85,"input",45),b("ngModelChange",function(s){return m(u),C(r.form.is_early_leave,s)||(r.form.is_early_leave=s),p(s)}),n(),t(86,"span"),a(87,"\u0627\u0646\u0635\u0631\u0627\u0641 \u0645\u0628\u0643\u0631\u061F"),n()()(),t(88,"div",26)(89,"label",43)(90,"input",46),b("ngModelChange",function(s){return m(u),C(r.form.is_auto,s)||(r.form.is_auto=s),p(s)}),n(),t(91,"span"),a(92,"\u062A\u0644\u0642\u0627\u0626\u064A\u061F"),n()()(),t(93,"div",47)(94,"label",48),a(95,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A"),n(),t(96,"input",49),b("ngModelChange",function(s){return m(u),C(r.form.notes,s)||(r.form.notes=s),p(s)}),n()(),t(97,"div",47)(98,"label",50),a(99,"\u0633\u0628\u0628 \u0627\u0644\u063A\u064A\u0627\u0628"),n(),t(100,"input",51),b("ngModelChange",function(s){return m(u),C(r.form.absence_reason,s)||(r.form.absence_reason=s),p(s)}),n()()(),h(101,ht,4,1,"p",52),n()(),h(102,yt,8,3,"div",53)(103,Ct,9,5,"div",53),n()(),t(104,"div",18),f("click",function(s){return m(u),p(r.onDeleteOverlayClick(s))}),t(105,"div",54)(106,"div",20)(107,"h3"),a(108,"\u062A\u0623\u0643\u064A\u062F \u062D\u0630\u0641 \u0633\u062C\u0644 \u0627\u0644\u062D\u0636\u0648\u0631"),n(),t(109,"button",21),f("click",function(){return m(u),p(r.closeDeleteModal())}),t(110,"span",22),a(111,"\xD7"),n()()(),t(112,"div",23)(113,"div",55)(114,"div",56),Se(),t(115,"svg",57),S(116,"circle",58)(117,"line",59)(118,"line",60),n()(),Ee(),t(119,"h4"),a(120,"\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 \u0633\u062C\u0644 \u0627\u0644\u062D\u0636\u0648\u0631\u061F"),n(),t(121,"p"),a(122,"\u0633\u064A\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u0633\u062C\u0644 \u0628\u0634\u0643\u0644 \u0646\u0647\u0627\u0626\u064A \u0648\u0644\u0627 \u064A\u0645\u0643\u0646 \u0627\u0633\u062A\u0631\u062C\u0627\u0639\u0647 \u0644\u0627\u062D\u0642\u064B\u0627."),n()(),t(123,"div",61)(124,"app-button",62),f("click",function(){return m(u),p(r.onConfirmDelete())}),a(125),n(),t(126,"app-button",63),f("click",function(){return m(u),p(r.closeDeleteModal())}),a(127,"\u0625\u0644\u063A\u0627\u0621"),n()()()()(),h(128,bt,2,0,"p",64)(129,vt,2,1,"p",65)(130,xt,2,0,"div",66)(131,At,34,1,"div",67)(132,kt,2,0,"p",64)}e&2&&(l(4),y("ngModel",r.searchQuery),l(8),y("ngModel",r.selectedUserId),l(),d("ngValue",null),l(2),d("ngForOf",r.users),l(4),y("ngModel",r.selectedMonth),l(3),y("ngModel",r.showThumbnails),l(3),E("visible",r.modalOpen),l(),E("visible",r.modalOpen),l(3),_(r.editMode?"\u062A\u0639\u062F\u064A\u0644 \u0633\u062C\u0644 \u0627\u0644\u062D\u0636\u0648\u0631":"\u0625\u0636\u0627\u0641\u0629 \u0633\u062C\u0644 \u062D\u0636\u0648\u0631 \u062C\u062F\u064A\u062F"),l(11),y("ngModel",r.form.user_id),d("disabled",r.saving),l(),d("ngValue",null),l(2),d("ngForOf",r.users),l(4),y("ngModel",r.form.branch_id),d("disabled",r.saving),l(),d("ngValue",null),l(2),d("ngForOf",r.branches),l(4),y("ngModel",r.form.attendance_type_id),d("disabled",r.saving),l(),d("ngValue",null),l(2),d("ngForOf",r.types),l(4),y("ngModel",r.form.recorded_at),d("disabled",r.saving),l(4),y("ngModel",r.form.image_url),d("disabled",r.saving),l(4),y("ngModel",r.form.latitude),d("disabled",r.saving),l(4),y("ngModel",r.form.longitude),d("disabled",r.saving),l(4),y("ngModel",r.form.worked_minutes),d("disabled",r.saving),l(3),y("ngModel",r.form.is_late),d("disabled",r.saving),l(5),y("ngModel",r.form.is_early_leave),d("disabled",r.saving),l(5),y("ngModel",r.form.is_auto),d("disabled",r.saving),l(6),y("ngModel",r.form.notes),d("disabled",r.saving),l(4),y("ngModel",r.form.absence_reason),d("disabled",r.saving),l(),d("ngIf",r.formError),l(),d("ngIf",!r.confirm),l(),d("ngIf",r.confirm),l(),E("visible",r.showDeleteModal),l(),E("visible",r.showDeleteModal),l(19),d("disabled",r.saving),l(),_(r.saving?"\u062C\u0627\u0631\u064A \u0627\u0644\u062D\u0630\u0641...":"\u0646\u0639\u0645\u060C \u0627\u062D\u0630\u0641 \u0627\u0644\u0633\u062C\u0644"),l(),d("disabled",r.saving),l(2),d("ngIf",r.loading),l(),d("ngIf",r.error),l(),d("ngIf",!r.loading&&!r.selectedUserId),l(),d("ngIf",!r.loading&&r.selectedUserId&&r.filteredItems.length),l(),d("ngIf",!r.loading&&r.selectedUserId&&!r.filteredItems.length&&!r.error))},dependencies:[F,R,I,B,H,$,J,Y,de,Je,K,L,q,Q,ce,N,G,Z,Ze,j],styles:["[_nghost-%COMP%]{direction:rtl;text-align:right;--primary-color: #f6b819;--primary-dark: #e0a800;--danger-color: #dc3545;--border-color: #e2e8f0;--text-muted: #64748b;--shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, .05);--shadow-md: 0 4px 6px -1px rgba(0, 0, 0, .1), 0 2px 4px -1px rgba(0, 0, 0, .06);--radius-md: 8px;--radius-lg: 12px;--transition: all .2s ease-in-out}.actions-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin:1.5rem 0;gap:1rem;flex-wrap:wrap}.search-section[_ngcontent-%COMP%]{flex:1;min-width:320px;max-width:100%}.actions-section[_ngcontent-%COMP%]{display:flex;gap:.75rem;flex-wrap:wrap}.filters-bar[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap;margin:0 0 1rem}.filter-item[_ngcontent-%COMP%]{min-width:220px}.filter-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.35rem;color:#334155;font-weight:600}.filter-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .filter-item[_ngcontent-%COMP%]   input[type=month][_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid var(--border-color);border-radius:var(--radius-md)}.filter-item.toggle-thumb[_ngcontent-%COMP%]{display:flex;align-items:end;min-width:180px}.checkbox-inline[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;margin-bottom:.35rem}.hint-select-user[_ngcontent-%COMP%]{margin:.5rem 0 1rem;color:var(--text-muted);font-weight:500}.table-container[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}.app-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;background:#fff;border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);overflow:hidden}.app-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:var(--primary-dark);color:#fff;padding:.75rem 1rem;text-align:right;font-weight:600}.app-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border-top:1px solid var(--border-color);vertical-align:middle}.actions[_ngcontent-%COMP%]{white-space:nowrap}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:flex-end}.btn-icon[_ngcontent-%COMP%]{margin-left:.25rem}.thumb[_ngcontent-%COMP%]{width:48px;height:48px;object-fit:cover;border-radius:6px;border:1px solid var(--border-color)}.img-link[_ngcontent-%COMP%]{text-decoration:none;color:inherit}.open-img-text[_ngcontent-%COMP%]{padding:4px 8px;background:#f1f5f9;border-radius:6px;border:1px solid var(--border-color);font-size:.85rem;color:#334155}.map-link[_ngcontent-%COMP%]{margin-inline-start:8px;padding:2px 6px;background:#e8f3ff;border:1px solid #cfe3ff;border-radius:6px;color:#0b5ed7;font-weight:600;font-size:.8rem;text-decoration:none}.map-link[_ngcontent-%COMP%]:hover{background:#dff0ff}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;width:100vw;height:100vh;background:#00000080;display:grid;place-items:center;z-index:100000;opacity:0;visibility:hidden;transition:var(--transition);padding:2rem;overflow:auto}.modal-overlay.visible[_ngcontent-%COMP%]{opacity:1;visibility:visible}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:12px;max-width:90vw;max-height:90vh;display:flex;flex-direction:column;transform:translateY(20px);transition:var(--transition);opacity:0;box-shadow:0 10px 30px #0000004d;margin:0;overflow:hidden}.user-modal[_ngcontent-%COMP%]{width:800px}.delete-modal[_ngcontent-%COMP%]{width:500px}.modal.visible[_ngcontent-%COMP%]{transform:translateY(0);opacity:1}.modal-header[_ngcontent-%COMP%]{padding:1.5rem;border-bottom:1px solid var(--border-color);display:flex;align-items:center;justify-content:space-between}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.3rem;font-weight:600;color:var(--color-primary-dark)}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;color:var(--muted-text);padding:.25rem;border-radius:4px;transition:all .2s ease}.close-btn[_ngcontent-%COMP%]:hover{background:var(--border-color);color:var(--text-color)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;flex:1}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem;margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]{margin-bottom:.25rem}.form-group.full-width[_ngcontent-%COMP%]{grid-column:1/-1}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500;color:#334155;font-size:.9375rem}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:.625rem .875rem;border:1px solid var(--border-color);border-radius:var(--radius-md);font-size:.9375rem;transition:var(--transition);background-color:#fff}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px #f6b81933}.checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-top:1.75rem}.modal-footer-actions[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:1px solid var(--border-color);background:#f8fafc;border-bottom-left-radius:var(--radius-lg);border-bottom-right-radius:var(--radius-lg);margin-top:auto}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;margin-bottom:.75rem}.confirmation-message[_ngcontent-%COMP%]{text-align:center}.confirmation-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1rem;color:#1e293b;font-weight:500}.hint-text[_ngcontent-%COMP%]{color:var(--text-muted);font-size:.875rem;margin:0;text-align:center}.delete-warning[_ngcontent-%COMP%]{text-align:center;padding:1rem 0}.warning-icon[_ngcontent-%COMP%]{margin-bottom:1rem}.delete-warning[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.125rem;color:#1e293b}.delete-warning[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#64748b;line-height:1.5}.delete-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:.75rem;margin-top:1.5rem}.error-message[_ngcontent-%COMP%]{color:var(--danger-color);background-color:#fef2f2;padding:.75rem 1rem;border-radius:var(--radius-md);margin:1rem 0 0;display:flex;align-items:flex-start;gap:.5rem;font-size:.9375rem}@media (max-width: 900px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (max-width: 640px){.actions-bar[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.search-section[_ngcontent-%COMP%]{max-width:100%}.action-buttons[_ngcontent-%COMP%], .delete-actions[_ngcontent-%COMP%]{flex-direction:column;width:100%}app-button[_ngcontent-%COMP%]{width:100%;justify-content:center}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};function It(o,i){if(o&1&&(t(0,"option",8),a(1),n()),o&2){let e=i.$implicit;d("ngValue",e.id),l(),_(e.full_name)}}function Dt(o,i){if(o&1&&(t(0,"option",8),a(1),n()),o&2){let e=i.$implicit;d("ngValue",e.id),l(),_(e.name)}}function Tt(o,i){if(o&1&&(t(0,"option",8),a(1),n()),o&2){let e=i.$implicit;d("ngValue",e),l(),_(e)}}function Ft(o,i){if(o&1&&(t(0,"div",21)(1,"span"),a(2,"\u26A0\uFE0F"),n(),t(3,"p"),a(4),n()()),o&2){let e=g();l(4),_(e.error)}}function Vt(o,i){o&1&&(t(0,"div",22),S(1,"app-spinner"),n())}function Rt(o,i){if(o&1&&(t(0,"span",40),S(1,"i",41),n()),o&2){let e=g().$implicit;d("title",e.notes)}}function Lt(o,i){if(o&1&&(t(0,"div",36)(1,"span",37),a(2),n(),t(3,"span",38),a(4),n(),h(5,Rt,2,1,"span",39),n()),o&2){let e=i.$implicit,r=g(4);E("check-in",e.attendance_type_id==="check_in"),l(2),_(r.getRecordType(e.attendance_type_id)),l(2),_(r.formatDateTime(e.recorded_at)),l(),d("ngIf",e.notes)}}function Nt(o,i){if(o&1&&(t(0,"div",34),h(1,Lt,6,5,"div",35),n()),o&2){let e=g().$implicit;l(),d("ngForOf",e.records)}}function Bt(o,i){o&1&&(t(0,"span"),a(1,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0633\u062C\u0644\u0627\u062A"),n())}function Wt(o,i){if(o&1&&(t(0,"tr")(1,"td"),a(2),x(3,"date"),n(),t(4,"td"),a(5),n(),t(6,"td"),a(7),x(8,"number"),n(),t(9,"td"),h(10,Nt,2,1,"div",32)(11,Bt,2,0,"span",33),n()()),o&2){let e=i.$implicit,r=g(2);E("weekend",r.isWeekend(e.date))("no-records",!e.records||e.records.length===0)("single-record",e.records&&e.records.length===1),l(2),_(w(3,11,e.date,"yyyy/MM/dd")),l(3),_(r.getDayName(e.date)),l(2),v("",w(8,14,e.total_hours,"1.0-2")," \u0633\u0627\u0639\u0629"),l(3),d("ngIf",(e.records==null?null:e.records.length)>0),l(),d("ngIf",!e.records||e.records.length===0)}}function zt(o,i){if(o&1&&(t(0,"div",23)(1,"div",24)(2,"h3"),a(3,"\u0645\u0644\u062E\u0635 \u0627\u0644\u062A\u0642\u0631\u064A\u0631"),n(),t(4,"div",25)(5,"div",26)(6,"span",27),a(7,"\u0627\u0644\u0634\u0647\u0631:"),n(),t(8,"span",28),a(9),n()(),t(10,"div",26)(11,"span",27),a(12,"\u0625\u062C\u0645\u0627\u0644\u064A \u0633\u0627\u0639\u0627\u062A \u0627\u0644\u0639\u0645\u0644:"),n(),t(13,"span",28),a(14),x(15,"number"),n()()()(),t(16,"div",29)(17,"table",30)(18,"thead")(19,"tr")(20,"th"),a(21,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E"),n(),t(22,"th"),a(23,"\u0627\u0644\u064A\u0648\u0645"),n(),t(24,"th"),a(25,"\u0633\u0627\u0639\u0627\u062A \u0627\u0644\u0639\u0645\u0644"),n(),t(26,"th"),a(27,"\u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644"),n()()(),t(28,"tbody"),h(29,Wt,12,17,"tr",31),n()()()()),o&2){let e=g();l(9),ue("",e.getMonthName(e.form.month)," ",e.form.year),l(5),v("",w(15,4,e.totalHours,"1.0-2")," \u0633\u0627\u0639\u0629"),l(15),d("ngForOf",e.reportData)}}function jt(o,i){o&1&&(t(0,"div",42)(1,"p"),a(2,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A \u0645\u062A\u0627\u062D\u0629 \u0644\u0644\u0639\u0631\u0636"),n()())}function Ut(o,i){o&1&&(t(0,"div",22),S(1,"app-spinner"),n())}function Yt(o,i){if(o&1&&(t(0,"div",21)(1,"span"),a(2,"\u26A0\uFE0F"),n(),t(3,"p"),a(4),n()()),o&2){let e=g(2);l(4),_(e.salaryError)}}function qt(o,i){if(o&1&&(t(0,"div",45)(1,"div",46)(2,"div",47)(3,"h4"),a(4,"\u0627\u0644\u0631\u0627\u062A\u0628 \u0627\u0644\u0623\u0633\u0627\u0633\u064A"),n(),t(5,"div",48),a(6),x(7,"number"),n()(),t(8,"div",47)(9,"h4"),a(10,"\u0625\u062C\u0645\u0627\u0644\u064A \u0623\u064A\u0627\u0645 \u0627\u0644\u0634\u0647\u0631"),n(),t(11,"div",48),a(12),n()(),t(13,"div",47)(14,"h4"),a(15,"\u0623\u064A\u0627\u0645 \u0627\u0644\u0639\u0645\u0644 \u0627\u0644\u0641\u0639\u0644\u064A\u0629"),n(),t(16,"div",48),a(17),n()()(),t(18,"div",46)(19,"div",47)(20,"h4"),a(21,"\u0623\u064A\u0627\u0645 \u0627\u0644\u062D\u0636\u0648\u0631"),n(),t(22,"div",48),a(23),n()(),t(24,"div",47)(25,"h4"),a(26,"\u0623\u064A\u0627\u0645 \u0627\u0644\u063A\u064A\u0627\u0628"),n(),t(27,"div",48),a(28),n()(),t(29,"div",47)(30,"h4"),a(31,"\u0623\u064A\u0627\u0645 \u0627\u0644\u0625\u062C\u0627\u0632\u0629 \u0627\u0644\u0631\u0633\u0645\u064A\u0629"),n(),t(32,"div",48),a(33),n()()(),t(34,"div",46)(35,"div",47)(36,"h4"),a(37,"\u0633\u0627\u0639\u0627\u062A \u0627\u0644\u0639\u0645\u0644 \u0627\u0644\u0641\u0639\u0644\u064A\u0629"),n(),t(38,"div",48),a(39),x(40,"number"),n()(),t(41,"div",47)(42,"h4"),a(43,"\u0627\u0644\u062F\u0642\u0627\u0626\u0642 \u0627\u0644\u0625\u0636\u0627\u0641\u064A\u0629"),n(),t(44,"div",48),a(45),n()(),t(46,"div",47)(47,"h4"),a(48,"\u0627\u0644\u062F\u0642\u0627\u0626\u0642 \u0627\u0644\u0646\u0627\u0642\u0635\u0629"),n(),t(49,"div",48),a(50),n()()(),t(51,"div",49)(52,"div",50)(53,"span",51),a(54,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0625\u0636\u0627\u0641\u0627\u062A:"),n(),t(55,"span",52),a(56),x(57,"number"),n()(),t(58,"div",50)(59,"span",51),a(60,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u062E\u0635\u0648\u0645\u0627\u062A:"),n(),t(61,"span",52),a(62),x(63,"number"),n()(),t(64,"div",53)(65,"span",51),a(66,"\u0635\u0627\u0641\u064A \u0627\u0644\u0631\u0627\u062A\u0628:"),n(),t(67,"span",52),a(68),x(69,"number"),n()()()()),o&2){let e=g(2);l(6),v("",w(7,12,e.salaryData.base_salary,"1.2-2")," \u062C.\u0645"),l(6),_(e.salaryData.days_in_month),l(5),_(e.salaryData.working_days),l(6),_(e.salaryData.present_days),l(5),_(e.salaryData.absent_days),l(5),_(e.salaryData.official_off_days),l(6),v("",w(40,15,e.salaryData.worked_minutes/60,"1.0-2")," \u0633\u0627\u0639\u0629"),l(6),v("",e.salaryData.extra_minutes," \u062F\u0642\u064A\u0642\u0629"),l(5),v("",e.salaryData.missing_minutes," \u062F\u0642\u064A\u0642\u0629"),l(6),v("",w(57,18,e.salaryData.additions,"1.2-2")," \u062C.\u0645"),l(6),v("",w(63,21,e.salaryData.deductions,"1.2-2")," \u062C.\u0645"),l(6),v("",w(69,24,e.salaryData.final_salary,"1.2-2")," \u062C.\u0645")}}function Gt(o,i){if(o&1&&(t(0,"div",43)(1,"h3"),a(2,"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u0645\u0631\u062A\u0628"),n(),h(3,Ut,2,0,"div",17)(4,Yt,5,1,"div",16)(5,qt,70,27,"div",44),n()),o&2){let e=g();l(3),d("ngIf",e.loadingSalary),l(),d("ngIf",e.salaryError),l(),d("ngIf",!e.loadingSalary&&!e.salaryError)}}var he=class o{constructor(i){this.sb=i;let e=new Date().getFullYear();this.years=Array.from({length:5},(r,u)=>e-2+u),this.months=Array.from({length:12},(r,u)=>({id:u+1,name:new Date(2e3,u,1).toLocaleString("ar-EG",{month:"long"})}))}loading=!1;loadingReport=!1;error="";users=[];years=[];months=[];form={user_id:"",year:new Date().getFullYear(),month:new Date().getMonth()+1};reportData=[];totalHours=0;salaryData=null;loadingSalary=!1;salaryError="";ngOnInit(){return M(this,null,function*(){yield this.loadUsers()})}loadUsers(){return M(this,null,function*(){this.loading=!0,this.error="";try{let{data:i,error:e}=yield this.sb.rpc("users_get");if(e)throw e;this.users=i||[]}catch(i){this.error=i?.message??"\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645\u064A\u0646"}finally{this.loading=!1}})}generateReport(){return M(this,null,function*(){if(!this.form.user_id){this.error="\u0627\u0644\u0631\u062C\u0627\u0621 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0645\u0648\u0638\u0641";return}console.log("Starting report generation..."),this.loadingReport=!0,this.loadingSalary=!0,this.error="",this.salaryError="",this.salaryData=null,this.reportData=[];try{console.log("Fetching report for:",{user_id:this.form.user_id,year:this.form.year,month:this.form.month});let{data:i,error:e}=yield this.sb.rpc("get_monthly_attendance_by_days",{p_user_id:this.form.user_id,p_year:this.form.year,p_month:this.form.month});if(console.log("Raw RPC response:",{data:i,error:e}),e)throw console.error("RPC Error:",e),new Error(e.message||"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0633\u062A\u0631\u062C\u0627\u0639 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u062D\u0636\u0648\u0631");if(!i)throw new Error("\u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A \u0645\u062A\u0627\u062D\u0629");Array.isArray(i)&&i.length>0?i[0]?.get_monthly_attendance_by_days?this.reportData=i[0].get_monthly_attendance_by_days:this.reportData=i:typeof i=="object"&&i!==null?this.reportData=[i]:this.reportData=[],console.log("Processed report data:",this.reportData),console.log("Processed report data:",this.reportData),this.calculateTotals(),yield this.loadSalaryData()}catch(i){console.error("Error generating report:",i),this.error="\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062A\u0642\u0631\u064A\u0631: "+(i.message||"Unknown error"),this.reportData=[]}finally{this.loadingReport=!1,this.loadingSalary=!1}})}calculateTotals(){this.totalHours=this.reportData.reduce((i,e)=>i+(e.total_hours||0),0)}getMonthName(i){return this.months.find(e=>e.id===i)?.name||""}formatTime(i){if(!i)return"00:00";let e=Math.floor(i/60),r=i%60;return`${e.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}formatDateTime(i){return i?new Date(i).toLocaleString("ar-EG",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):""}getRecordType(i){if(typeof i=="string"){if(i.toLowerCase().includes("check_in")||i==="cf73cd53-bec6-4932-aa69-389503eaef54")return"\u062D\u0636\u0648\u0631";if(i.toLowerCase().includes("check_out")||i==="6a1b3445-1991-45fe-9dee-92cacf71006e")return"\u0627\u0646\u0635\u0631\u0627\u0641"}return"\u062D\u0636\u0648\u0631"}getDayName(i){return new Date(i).toLocaleDateString("ar-EG",{weekday:"long"})}isWeekend(i){let r=new Date(i).getDay();return r===5||r===6}loadSalaryData(){return M(this,null,function*(){if(this.form.user_id){this.loadingSalary=!0,this.salaryError="";try{console.log("Loading salary data for:",{p_user_id:this.form.user_id,p_year:this.form.year,p_month:this.form.month});let{data:i,error:e}=yield this.sb.rpc("calculate_monthly_salary",{p_user_id:this.form.user_id,p_year:this.form.year,p_month:this.form.month});if(console.log("Salary data response:",{data:i,error:e}),e)throw e;if(i&&typeof i=="object"&&!Array.isArray(i)?this.salaryData=i:Array.isArray(i)&&i.length>0&&(this.salaryData=i[0]?.calculate_monthly_salary||i[0]||null),!this.salaryData)throw console.warn("No salary data found in response:",i),new Error("\u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A \u0645\u0631\u062A\u0628 \u0645\u062A\u0627\u062D\u0629");console.log("Processed salary data:",this.salaryData)}catch(i){console.error("Error loading salary data:",i),this.salaryError="\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062D\u0633\u0627\u0628 \u0627\u0644\u0631\u0627\u062A\u0628: "+(i.message||"Unknown error")}finally{this.loadingSalary=!1}}})}static \u0275fac=function(e){return new(e||o)(O(A))};static \u0275cmp=k({type:o,selectors:[["app-employee-monthly-report"]],decls:32,vars:13,consts:[[1,"page-container"],[1,"page-header"],[1,"card","filter-card"],[1,"filter-form"],[1,"form-row"],[1,"form-field"],["for","user"],["id","user",1,"form-control",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["for","month"],["id","month",1,"form-control",3,"ngModelChange","ngModel"],["for","year"],["id","year",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-actions"],[3,"btnClick","loading","disabled"],["class","error-message",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","report-container",4,"ngIf"],["class","no-data",4,"ngIf"],["class","salary-card card",4,"ngIf"],[1,"error-message"],[1,"loading-container"],[1,"report-container"],[1,"report-summary"],[1,"summary-grid"],[1,"summary-item"],[1,"label"],[1,"value"],[1,"table-responsive"],[1,"report-table"],[3,"weekend","no-records","single-record",4,"ngFor","ngForOf"],["class","records-list",4,"ngIf"],[4,"ngIf"],[1,"records-list"],["class","record-item",3,"check-in",4,"ngFor","ngForOf"],[1,"record-item"],[1,"record-type"],[1,"record-time"],["class","record-notes",3,"title",4,"ngIf"],[1,"record-notes",3,"title"],[1,"fas","fa-sticky-note"],[1,"no-data"],[1,"salary-card","card"],["class","salary-details",4,"ngIf"],[1,"salary-details"],[1,"salary-row"],[1,"salary-group"],[1,"salary-value"],[1,"salary-totals"],[1,"total-row"],[1,"total-label"],[1,"total-value"],[1,"total-row","final-salary"]],template:function(e,r){e&1&&(t(0,"div",0)(1,"div",1)(2,"h1"),a(3,"\u062A\u0642\u0631\u064A\u0631 \u0634\u0647\u0631\u064A \u0644\u0644\u0645\u0648\u0638\u0641"),n()(),t(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"label",6),a(9,"\u0627\u0644\u0645\u0648\u0638\u0641"),n(),t(10,"select",7),b("ngModelChange",function(c){return C(r.form.user_id,c)||(r.form.user_id=c),c}),t(11,"option",8),a(12,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0645\u0648\u0638\u0641"),n(),h(13,It,2,2,"option",9),n()(),t(14,"div",5)(15,"label",10),a(16,"\u0627\u0644\u0634\u0647\u0631"),n(),t(17,"select",11),b("ngModelChange",function(c){return C(r.form.month,c)||(r.form.month=c),c}),h(18,Dt,2,2,"option",9),n()(),t(19,"div",5)(20,"label",12),a(21,"\u0627\u0644\u0633\u0646\u0629"),n(),t(22,"select",13),b("ngModelChange",function(c){return C(r.form.year,c)||(r.form.year=c),c}),h(23,Tt,2,2,"option",9),n()(),t(24,"div",14)(25,"app-button",15),f("btnClick",function(){return r.generateReport()}),a(26," \u0639\u0631\u0636 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 "),n()()()()(),h(27,Ft,5,1,"div",16)(28,Vt,2,0,"div",17)(29,zt,30,7,"div",18)(30,jt,3,0,"div",19)(31,Gt,6,3,"div",20),n()),e&2&&(l(10),y("ngModel",r.form.user_id),l(3),d("ngForOf",r.users),l(4),y("ngModel",r.form.month),l(),d("ngForOf",r.months),l(4),y("ngModel",r.form.year),l(),d("ngForOf",r.years),l(2),d("loading",r.loadingReport)("disabled",r.loading||!r.form.user_id),l(2),d("ngIf",r.error),l(),d("ngIf",r.loading),l(),d("ngIf",!r.loading&&r.reportData.length>0),l(),d("ngIf",!r.loading&&r.reportData.length===0&&r.form.user_id),l(),d("ngIf",r.salaryData))},dependencies:[F,R,I,B,$,J,K,L,N,Z,X,U,j],styles:['[_ngcontent-%COMP%]:root{--color-primary: #3b82f6;--color-primary-dark: #2563eb;--text-color: #1f2937;--muted-text: #6b7280;--border-color: #e5e7eb;--font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif}.page-container[_ngcontent-%COMP%]{padding:1.5rem;max-width:1200px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:var(--color-primary);font-size:1.75rem;font-weight:600;margin:0}.card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000000d;margin-bottom:2rem;padding:1.5rem}.filter-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;align-items:flex-end}.filter-form[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{flex:1;min-width:200px}.filter-form[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500;color:var(--text-color)}.filter-form[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .filter-form[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid var(--border-color);border-radius:4px;font-size:1rem;transition:border-color .2s}.filter-form[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .filter-form[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--color-primary)}.filter-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{margin-top:1.5rem;display:flex;justify-content:flex-start}.error-message[_ngcontent-%COMP%]{background-color:#fee2e2;color:#b91c1c;padding:1rem;border-radius:4px;margin-bottom:1.5rem;display:flex;align-items:center;gap:.5rem}.error-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1.25rem}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:2rem}.report-container[_ngcontent-%COMP%]{margin-top:2rem}.report-summary[_ngcontent-%COMP%]{background:#f8fafc;border-radius:8px;padding:1.5rem;margin-bottom:1.5rem}.report-summary[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;margin-bottom:1rem;color:var(--color-primary)}.summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:1rem}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.75rem 1rem;background:#fff;border-radius:6px;box-shadow:0 1px 2px #0000000d}.summary-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:var(--text-color)}.summary-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;color:var(--color-primary-dark)}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto;background:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a}.report-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.report-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .report-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;text-align:right;border-bottom:1px solid var(--border-color)}.report-table[_ngcontent-%COMP%]   tr.no-records[_ngcontent-%COMP%]{background-color:#fef2f2}.report-table[_ngcontent-%COMP%]   tr.no-records[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#dc2626;font-weight:500}.report-table[_ngcontent-%COMP%]   tr.no-records[_ngcontent-%COMP%]:hover{background-color:#fee2e2}.report-table[_ngcontent-%COMP%]   tr.single-record[_ngcontent-%COMP%], .report-table[_ngcontent-%COMP%]   tr.single-record.weekend[_ngcontent-%COMP%]{background-color:#fffbeb!important}.report-table[_ngcontent-%COMP%]   tr.single-record[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .report-table[_ngcontent-%COMP%]   tr.single-record.weekend[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#d97706;font-weight:500}.report-table[_ngcontent-%COMP%]   tr.single-record[_ngcontent-%COMP%]:hover, .report-table[_ngcontent-%COMP%]   tr.single-record.weekend[_ngcontent-%COMP%]:hover{background-color:#fef3c7!important}.report-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8fafc;font-weight:600;color:var(--color-primary-dark);text-transform:uppercase;font-size:.75rem;letter-spacing:.05em}.report-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.report-table[_ngcontent-%COMP%]   tr.weekend[_ngcontent-%COMP%]{background-color:#f8fafc}.records-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.record-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.5rem;border-radius:4px;background-color:#f1f5f9;font-size:.875rem}.record-item.check-in[_ngcontent-%COMP%]{background-color:#e0f2fe;border-right:3px solid var(--color-primary)}.record-item[_ngcontent-%COMP%]   .record-type[_ngcontent-%COMP%]{font-weight:500;color:var(--color-primary-dark);min-width:60px}.record-item[_ngcontent-%COMP%]   .record-time[_ngcontent-%COMP%]{color:var(--text-color);direction:ltr;display:inline-block}.record-item[_ngcontent-%COMP%]   .record-notes[_ngcontent-%COMP%]{margin-right:auto;color:var(--color-primary);cursor:help}.no-data[_ngcontent-%COMP%]{text-align:center;padding:3rem;background:#fff;border-radius:8px;color:var(--muted-text);font-size:1.1rem}.salary-card[_ngcontent-%COMP%]{margin-top:2rem;background:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a;padding:1.5rem}.salary-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--color-primary-dark);margin-top:0;margin-bottom:1.5rem;padding-bottom:.75rem;border-bottom:1px solid var(--border-color)}.salary-card[_ngcontent-%COMP%]   .salary-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.salary-card[_ngcontent-%COMP%]   .salary-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1rem}@media (max-width: 768px){.salary-card[_ngcontent-%COMP%]   .salary-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.salary-card[_ngcontent-%COMP%]   .salary-group[_ngcontent-%COMP%]{background:#f8fafc;padding:1rem;border-radius:6px;border-right:3px solid var(--color-primary)}.salary-card[_ngcontent-%COMP%]   .salary-group[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;color:var(--muted-text);font-size:.875rem;font-weight:500}.salary-card[_ngcontent-%COMP%]   .salary-group[_ngcontent-%COMP%]   .salary-value[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:var(--text-color)}.salary-card[_ngcontent-%COMP%]   .salary-totals[_ngcontent-%COMP%]{margin-top:1rem;background:#f8fafc;border-radius:6px;padding:1.5rem}.salary-card[_ngcontent-%COMP%]   .salary-totals[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.75rem 0;border-bottom:1px dashed var(--border-color)}.salary-card[_ngcontent-%COMP%]   .salary-totals[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.salary-card[_ngcontent-%COMP%]   .salary-totals[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{color:var(--muted-text);font-weight:500}.salary-card[_ngcontent-%COMP%]   .salary-totals[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]{font-weight:600;color:var(--text-color)}.salary-card[_ngcontent-%COMP%]   .salary-totals[_ngcontent-%COMP%]   .total-row.final-salary[_ngcontent-%COMP%]{margin-top:.5rem;padding-top:1rem;border-top:2px solid var(--border-color)}.salary-card[_ngcontent-%COMP%]   .salary-totals[_ngcontent-%COMP%]   .total-row.final-salary[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]{color:var(--color-primary-dark);font-size:1.25rem;font-weight:700}@media (max-width: 768px){.filter-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{flex-direction:column}.filter-form[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{width:100%}.summary-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}']})};function Ht(o,i){if(o&1&&(t(0,"option",28),a(1),n()),o&2){let e=i.$implicit;d("value",e.id),l(),_(e.full_name)}}function Kt(o,i){if(o&1&&(t(0,"div",29)(1,"span"),a(2,"\u26A0\uFE0F"),n(),t(3,"p"),a(4),n()()),o&2){let e=g();l(4),_(e.error)}}function $t(o,i){o&1&&(t(0,"div",30),S(1,"app-spinner"),n())}function Jt(o,i){if(o&1&&(t(0,"div",31)(1,"div",32)(2,"h3"),a(3,"\u0646\u062A\u064A\u062C\u0629 \u062D\u0633\u0627\u0628 \u0627\u0644\u0631\u0627\u062A\u0628"),n(),t(4,"div",33)(5,"div",34)(6,"div",35)(7,"span",36),a(8,"\u0627\u0644\u0641\u062A\u0631\u0629 \u0645\u0646"),n(),t(9,"span",37),a(10),x(11,"date"),n()(),t(12,"div",35)(13,"span",36),a(14,"\u0625\u0644\u0649"),n(),t(15,"span",37),a(16),x(17,"date"),n()(),t(18,"div",35)(19,"span",36),a(20,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0623\u064A\u0627\u0645"),n(),t(21,"span",37),a(22),n()()()(),t(23,"div",38)(24,"div",39)(25,"div",40)(26,"h4"),a(27,"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u0631\u0627\u062A\u0628"),n(),t(28,"div",41)(29,"span",36),a(30,"\u0627\u0644\u0631\u0627\u062A\u0628 \u0627\u0644\u0623\u0633\u0627\u0633\u064A"),n(),t(31,"span",37),a(32),x(33,"number"),n()(),t(34,"div",41)(35,"span",36),a(36,"\u0623\u064A\u0627\u0645 \u0627\u0644\u0639\u0645\u0644 \u0627\u0644\u0641\u0639\u0644\u064A\u0629"),n(),t(37,"span",37),a(38),n()(),t(39,"div",41)(40,"span",36),a(41,"\u0645\u062F\u0629 \u0627\u0644\u0648\u0631\u062F\u064A\u0629"),n(),t(42,"span",37),a(43),n()()(),t(44,"div",40)(45,"h4"),a(46,"\u0627\u0644\u062D\u0636\u0648\u0631 \u0648\u0627\u0644\u0627\u0646\u0635\u0631\u0627\u0641"),n(),t(47,"div",41)(48,"span",36),a(49,"\u0623\u064A\u0627\u0645 \u0627\u0644\u062D\u0636\u0648\u0631"),n(),t(50,"span",37),a(51),n()(),t(52,"div",41)(53,"span",36),a(54,"\u0623\u064A\u0627\u0645 \u0627\u0644\u063A\u064A\u0627\u0628"),n(),t(55,"span",37),a(56),n()(),t(57,"div",41)(58,"span",36),a(59,"\u0623\u064A\u0627\u0645 \u0627\u0644\u0625\u062C\u0627\u0632\u0629 \u0627\u0644\u0645\u0633\u0645\u0648\u062D \u0628\u0647\u0627"),n(),t(60,"span",37),a(61),n()()()(),t(62,"div",39)(63,"div",40)(64,"h4"),a(65,"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u0648\u0642\u062A"),n(),t(66,"div",41)(67,"span",36),a(68,"\u0625\u062C\u0645\u0627\u0644\u064A \u0633\u0627\u0639\u0627\u062A \u0627\u0644\u0639\u0645\u0644"),n(),t(69,"span",37),a(70),x(71,"number"),n()(),t(72,"div",41)(73,"span",36),a(74,"\u0627\u0644\u0648\u0642\u062A \u0627\u0644\u0645\u062A\u0648\u0642\u0639"),n(),t(75,"span",37),a(76),x(77,"number"),n()(),t(78,"div",41)(79,"span",36),a(80,"\u0627\u0644\u0648\u0642\u062A \u0627\u0644\u0625\u0636\u0627\u0641\u064A"),n(),t(81,"span",37),a(82),n()(),t(83,"div",41)(84,"span",36),a(85,"\u0627\u0644\u0648\u0642\u062A \u0627\u0644\u0646\u0627\u0642\u0635"),n(),t(86,"span",37),a(87),n()()(),t(88,"div",40)(89,"h4"),a(90,"\u062D\u0633\u0627\u0628 \u0627\u0644\u0631\u0627\u062A\u0628"),n(),t(91,"div",41)(92,"span",36),a(93,"\u0627\u0644\u0631\u0627\u062A\u0628 \u0627\u0644\u064A\u0648\u0645\u064A"),n(),t(94,"span",37),a(95),x(96,"number"),n()(),t(97,"div",41)(98,"span",36),a(99,"\u0627\u0644\u0631\u0627\u062A\u0628 \u0628\u0627\u0644\u0633\u0627\u0639\u0629"),n(),t(100,"span",37),a(101),x(102,"number"),n()(),t(103,"div",42)(104,"span",36),a(105,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0625\u0636\u0627\u0641\u0627\u062A"),n(),t(106,"span",37),a(107),x(108,"number"),n()(),t(109,"div",42)(110,"span",36),a(111,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u062E\u0635\u0648\u0645\u0627\u062A"),n(),t(112,"span",37),a(113),x(114,"number"),n()()()()(),t(115,"div",43)(116,"div",44)(117,"span",36),a(118,"\u0635\u0627\u0641\u064A \u0627\u0644\u0631\u0627\u062A\u0628 \u0627\u0644\u0645\u0633\u062A\u062D\u0642"),n(),t(119,"span",37),a(120),x(121,"number"),n()()()()()),o&2){let e=g();l(10),_(w(11,18,e.salaryData.start_date,"yyyy/MM/dd")),l(6),_(w(17,21,e.salaryData.end_date,"yyyy/MM/dd")),l(6),_(e.salaryData.days_in_range),l(10),v("",w(33,24,e.salaryData.base_salary,"1.2-2")," \u062C.\u0645"),l(6),v("",e.salaryData.working_days," \u064A\u0648\u0645"),l(5),v("",e.salaryData.shift_hours," \u0633\u0627\u0639\u0629"),l(8),v("",e.salaryData.present_days," \u064A\u0648\u0645"),l(5),v("",e.salaryData.absent_days," \u064A\u0648\u0645"),l(5),v("",e.salaryData.allowed_off_days," \u064A\u0648\u0645"),l(9),v("",w(71,27,e.salaryData.worked_minutes/60,"1.0-2")," \u0633\u0627\u0639\u0629"),l(6),v("",w(77,30,e.salaryData.expected_minutes/60,"1.0-2")," \u0633\u0627\u0639\u0629"),l(6),_(e.formatMinutes(e.salaryData.extra_minutes)),l(5),_(e.formatMinutes(e.salaryData.missing_minutes)),l(8),v("",w(96,33,e.salaryData.daily_salary,"1.2-2")," \u062C.\u0645"),l(6),v("",w(102,36,e.salaryData.hourly_salary,"1.2-2")," \u062C.\u0645"),l(6),v("",w(108,39,e.salaryData.additions,"1.2-2")," \u062C.\u0645"),l(6),v("",w(114,42,e.salaryData.deductions,"1.2-2")," \u062C.\u0645"),l(7),v("",w(121,45,e.salaryData.final_salary,"1.2-2")," \u062C.\u0645")}}var ye=class o{constructor(i){this.sb=i}loading=!1;error="";salaryData=null;form={user_id:"",start_date:new Date().toISOString().split("T")[0],end_date:new Date(new Date().setMonth(new Date().getMonth()+1)).toISOString().split("T")[0],base_salary:1e4,allowed_off_days:4,shift_hours:5};users=[];ngOnInit(){return M(this,null,function*(){yield this.loadUsers()})}loadUsers(){return M(this,null,function*(){try{this.loading=!0;let{data:i,error:e}=yield this.sb.rpc("users_get");if(e)throw e;this.users=i||[],this.users.length>0&&!this.form.user_id&&(this.form.user_id=this.users[0].id)}catch(i){console.error("Error loading users:",i),this.error="\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u0645\u064A\u0644 \u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0645\u0648\u0638\u0641\u064A\u0646"}finally{this.loading=!1}})}calculateSalary(){return M(this,null,function*(){if(!this.form.user_id){this.error="\u0627\u0644\u0631\u062C\u0627\u0621 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0645\u0648\u0638\u0641";return}this.loading=!0,this.error="",this.salaryData=null;try{console.log("Calculating instant salary with:",this.form);let{data:i,error:e}=yield this.sb.rpc("calculate_instant_salary",{p_user_id:this.form.user_id,p_start_date:this.form.start_date,p_end_date:this.form.end_date,p_base_salary:this.form.base_salary,p_allowed_off_days:this.form.allowed_off_days,p_shift_hours:this.form.shift_hours});if(console.log("Instant salary response:",{data:i,error:e}),e)throw e;if(i&&typeof i=="object"&&(Array.isArray(i)&&i.length>0?this.salaryData=i[0]?.calculate_instant_salary||i[0]||null:Array.isArray(i)||(this.salaryData=i)),!this.salaryData)throw new Error("\u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A \u0645\u062A\u0627\u062D\u0629 \u0644\u0644\u062D\u0633\u0627\u0628");console.log("Processed salary data:",this.salaryData)}catch(i){console.error("Error calculating salary:",i),this.error="\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062D\u0633\u0627\u0628 \u0627\u0644\u0631\u0627\u062A\u0628: "+(i.message||"Unknown error")}finally{this.loading=!1}})}formatNumber(i){return i?.toFixed(2)||"0.00"}formatMinutes(i){if(!i&&i!==0)return"0 \u0633\u0627\u0639\u0629";let e=Math.floor(i/60),r=i%60;return`${e} \u0633\u0627\u0639\u0629 ${r} \u062F\u0642\u064A\u0642\u0629`}static \u0275fac=function(e){return new(e||o)(O(A))};static \u0275cmp=k({type:o,selectors:[["app-instant-salary-calculator"]],decls:49,vars:12,consts:[["salaryForm","ngForm"],[1,"page-container"],[1,"page-header"],[1,"subtitle"],[1,"card","form-card"],[3,"ngSubmit"],[1,"form-row"],[1,"form-field"],["for","user"],["id","user","name","user_id","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","base_salary"],[1,"input-group"],["type","number","id","base_salary","name","base_salary","min","0","step","0.01","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-text"],["for","start_date"],["type","date","id","start_date","name","start_date","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","end_date"],["type","date","id","end_date","name","end_date","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","allowed_off_days"],["type","number","id","allowed_off_days","name","allowed_off_days","min","0","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","shift_hours"],["type","number","id","shift_hours","name","shift_hours","min","1","max","24","step","0.5","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-actions"],["type","submit",3,"loading","disabled"],["class","error-message",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","salary-results",4,"ngIf"],[3,"value"],[1,"error-message"],[1,"loading-container"],[1,"salary-results"],[1,"card"],[1,"salary-summary"],[1,"summary-row"],[1,"summary-item"],[1,"label"],[1,"value"],[1,"salary-details"],[1,"details-row"],[1,"details-group"],[1,"detail-item"],[1,"detail-item","highlight"],[1,"salary-total"],[1,"total-amount"]],template:function(e,r){if(e&1){let u=P();t(0,"div",1)(1,"div",2)(2,"h1"),a(3,"\u062D\u0633\u0627\u0628 \u0627\u0644\u0631\u0627\u062A\u0628 \u0627\u0644\u0641\u0648\u0631\u064A"),n(),t(4,"p",3),a(5,"\u0627\u062D\u0633\u0628 \u0627\u0644\u0631\u0627\u062A\u0628 \u0628\u0646\u0627\u0621\u064B \u0639\u0644\u0649 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u062D\u0636\u0648\u0631 \u0648\u0627\u0644\u0627\u0646\u0635\u0631\u0627\u0641"),n()(),t(6,"div",4)(7,"form",5,0),f("ngSubmit",function(){return m(u),p(r.calculateSalary())}),t(9,"div",6)(10,"div",7)(11,"label",8),a(12,"\u0627\u0644\u0645\u0648\u0638\u0641"),n(),t(13,"select",9),b("ngModelChange",function(s){return m(u),C(r.form.user_id,s)||(r.form.user_id=s),p(s)}),h(14,Ht,2,2,"option",10),n()(),t(15,"div",7)(16,"label",11),a(17,"\u0627\u0644\u0631\u0627\u062A\u0628 \u0627\u0644\u0623\u0633\u0627\u0633\u064A"),n(),t(18,"div",12)(19,"input",13),b("ngModelChange",function(s){return m(u),C(r.form.base_salary,s)||(r.form.base_salary=s),p(s)}),n(),t(20,"span",14),a(21,"\u062C.\u0645"),n()()()(),t(22,"div",6)(23,"div",7)(24,"label",15),a(25,"\u0645\u0646 \u062A\u0627\u0631\u064A\u062E"),n(),t(26,"input",16),b("ngModelChange",function(s){return m(u),C(r.form.start_date,s)||(r.form.start_date=s),p(s)}),n()(),t(27,"div",7)(28,"label",17),a(29,"\u0625\u0644\u0649 \u062A\u0627\u0631\u064A\u062E"),n(),t(30,"input",18),b("ngModelChange",function(s){return m(u),C(r.form.end_date,s)||(r.form.end_date=s),p(s)}),n()()(),t(31,"div",6)(32,"div",7)(33,"label",19),a(34,"\u0623\u064A\u0627\u0645 \u0627\u0644\u0625\u062C\u0627\u0632\u0629 \u0627\u0644\u0645\u0633\u0645\u0648\u062D \u0628\u0647\u0627"),n(),t(35,"input",20),b("ngModelChange",function(s){return m(u),C(r.form.allowed_off_days,s)||(r.form.allowed_off_days=s),p(s)}),n()(),t(36,"div",7)(37,"label",21),a(38,"\u0645\u062F\u0629 \u0627\u0644\u0648\u0631\u062F\u064A\u0629 (\u0633\u0627\u0639\u0627\u062A)"),n(),t(39,"div",12)(40,"input",22),b("ngModelChange",function(s){return m(u),C(r.form.shift_hours,s)||(r.form.shift_hours=s),p(s)}),n(),t(41,"span",14),a(42,"\u0633\u0627\u0639\u0629"),n()()()(),t(43,"div",23)(44,"app-button",24),a(45," \u0627\u062D\u0633\u0628 \u0627\u0644\u0631\u0627\u062A\u0628 "),n()()()(),h(46,Kt,5,1,"div",25)(47,$t,2,0,"div",26)(48,Jt,122,48,"div",27),n()}if(e&2){let u=V(8);l(13),y("ngModel",r.form.user_id),l(),d("ngForOf",r.users),l(5),y("ngModel",r.form.base_salary),l(7),y("ngModel",r.form.start_date),l(4),y("ngModel",r.form.end_date),l(5),y("ngModel",r.form.allowed_off_days),l(5),y("ngModel",r.form.shift_hours),l(4),d("loading",r.loading)("disabled",!u.form.valid||r.loading),l(2),d("ngIf",r.error),l(),d("ngIf",r.loading),l(),d("ngIf",r.salaryData)}},dependencies:[F,R,I,B,H,$,J,Y,de,K,L,q,Q,ce,Qe,N,G,Z,X,U,j],styles:["[_ngcontent-%COMP%]:root{--color-primary: #3b82f6;--color-primary-dark: #2563eb;--color-success: #10b981;--color-danger: #ef4444;--color-warning: #f59e0b;--text-color: #1f2937;--muted-text: #6b7280;--border-color: #e5e7eb;--bg-light: #f9fafb;--card-shadow: 0 1px 3px rgba(0, 0, 0, .1);--border-radius: .5rem}.page-container[_ngcontent-%COMP%]{padding:2rem;max-width:1200px;margin:0 auto}@media (max-width: 768px){.page-container[_ngcontent-%COMP%]{padding:1rem}}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem;text-align:center}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:var(--color-primary-dark);margin:0 0 .5rem}.page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:var(--muted-text);margin:0}.card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;box-shadow:var(--card-shadow);padding:2rem;margin-bottom:2rem;border:1px solid var(--border-color)}.card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--color-primary-dark);margin-top:0;margin-bottom:1.5rem;padding-bottom:.75rem;border-bottom:1px solid var(--border-color)}.form-card[_ngcontent-%COMP%]{margin-bottom:2.5rem;border-radius:16px}.form-card[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-card[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.form-card[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:2rem;margin-bottom:1.5rem}@media (max-width: 768px){.form-card[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{gap:1.5rem}}@media (max-width: 768px){.form-card[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.form-card[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{margin-bottom:1rem}.form-card[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500;color:var(--text-color)}.form-card[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid var(--border-color);border-radius:.375rem;font-size:1rem;line-height:1.5;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-card[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--color-primary);box-shadow:0 0 0 3px #3b82f633}.form-card[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{display:flex}.form-card[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-top-right-radius:0;border-bottom-right-radius:0;border-right:none}.form-card[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem .75rem;font-size:.875rem;font-weight:400;line-height:1.5;color:#6c757d;text-align:center;white-space:nowrap;background-color:#e9ecef;border:1px solid #ced4da;border-radius:0 .25rem .25rem 0}.form-card[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;margin-top:1.5rem}@media (max-width: 768px){.form-card[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{justify-content:stretch}.form-card[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}.salary-results[_ngcontent-%COMP%]   .salary-summary[_ngcontent-%COMP%]{background:var(--bg-light);border-radius:12px;padding:1.5rem;margin-bottom:2rem;border:1px solid rgba(0,0,0,.05)}.salary-results[_ngcontent-%COMP%]   .salary-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1.5rem}.salary-results[_ngcontent-%COMP%]   .salary-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{display:flex;flex-direction:column}.salary-results[_ngcontent-%COMP%]   .salary-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.875rem;color:var(--muted-text);margin-bottom:.25rem}.salary-results[_ngcontent-%COMP%]   .salary-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;color:var(--text-color)}.salary-results[_ngcontent-%COMP%]   .salary-details[_ngcontent-%COMP%]{margin:1.5rem 0}.salary-results[_ngcontent-%COMP%]   .salary-details[_ngcontent-%COMP%]   .details-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem;margin-bottom:1.5rem}@media (max-width: 768px){.salary-results[_ngcontent-%COMP%]   .salary-details[_ngcontent-%COMP%]   .details-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.salary-results[_ngcontent-%COMP%]   .salary-details[_ngcontent-%COMP%]   .details-group[_ngcontent-%COMP%]{background:var(--bg-light);border-radius:12px;padding:1.5rem;border:1px solid rgba(0,0,0,.05);transition:transform .2s ease,box-shadow .2s ease}.salary-results[_ngcontent-%COMP%]   .salary-details[_ngcontent-%COMP%]   .details-group[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000000d}.salary-results[_ngcontent-%COMP%]   .salary-details[_ngcontent-%COMP%]   .details-group[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:0;margin-bottom:1rem;color:var(--color-primary-dark);font-size:1rem;border-bottom:1px solid var(--border-color);padding-bottom:.5rem}.salary-results[_ngcontent-%COMP%]   .salary-details[_ngcontent-%COMP%]   .details-group[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0;border-bottom:1px dashed var(--border-color)}.salary-results[_ngcontent-%COMP%]   .salary-details[_ngcontent-%COMP%]   .details-group[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.salary-results[_ngcontent-%COMP%]   .salary-details[_ngcontent-%COMP%]   .details-group[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:var(--muted-text)}.salary-results[_ngcontent-%COMP%]   .salary-details[_ngcontent-%COMP%]   .details-group[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:500;color:var(--text-color)}.salary-results[_ngcontent-%COMP%]   .salary-details[_ngcontent-%COMP%]   .details-group[_ngcontent-%COMP%]   .detail-item.highlight[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;color:var(--color-primary-dark)}.salary-results[_ngcontent-%COMP%]   .salary-total[_ngcontent-%COMP%]{margin-top:2.5rem}.salary-results[_ngcontent-%COMP%]   .salary-total[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--color-primary),var(--color-primary-dark));color:#fff;padding:2rem;border-radius:16px;box-shadow:0 4px 20px #3b82f633;display:flex;justify-content:space-between;align-items:center}.salary-results[_ngcontent-%COMP%]   .salary-total[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:500}.salary-results[_ngcontent-%COMP%]   .salary-total[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:3rem 0}.error-message[_ngcontent-%COMP%]{background:#fef2f2;color:#b91c1c;padding:1rem;border-radius:var(--border-radius);margin:1rem 0;display:flex;align-items:flex-start;gap:.5rem}.error-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1.25rem}.error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}@media (max-width: 768px){.page-container[_ngcontent-%COMP%], .card[_ngcontent-%COMP%], .salary-results[_ngcontent-%COMP%]   .details-group[_ngcontent-%COMP%]{padding:1rem}.salary-results[_ngcontent-%COMP%]   .salary-total[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:.5rem}.salary-results[_ngcontent-%COMP%]   .salary-total[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.5rem}}"]})};var nt=[{path:"login",component:me},{path:"",canActivate:[Xe],children:[{path:"",pathMatch:"full",redirectTo:"login"},{path:"dashboard",component:_e},{path:"users",loadChildren:()=>import("./chunk-GX66BZQW.js").then(o=>o.UsersModule)},{path:"attendance-types",loadChildren:()=>import("./chunk-3LICIMTO.js").then(o=>o.AttendanceTypesModule)},{path:"attendance-records",component:fe},{path:"deductions",loadChildren:()=>import("./chunk-EBCXNKTV.js").then(o=>o.DeductionsModule)},{path:"additions",loadChildren:()=>import("./chunk-EYK2D5BG.js").then(o=>o.AdditionsModule)},{path:"reports/employee-monthly",component:he},{path:"reports/instant-salary",component:ye},{path:"request-statuses",loadChildren:()=>import("./chunk-FJZ72JCS.js").then(o=>o.RequestStatusesModule)},{path:"shifts",loadChildren:()=>import("./chunk-3U62OHVI.js").then(o=>o.ShiftsModule)},{path:"branches",loadChildren:()=>import("./chunk-JWLLJ5WD.js").then(o=>o.BranchesModule)}]},{path:"**",redirectTo:""}];function Qt(o){let i=o;return i===0?0:i===1?1:i===2?2:i%100===Math.floor(i%100)&&i%100>=3&&i%100<=10?3:i%100===Math.floor(i%100)&&i%100>=11&&i%100<=99?4:5}var it=["ar",[["\u0635","\u0645"],void 0,void 0],[["\u0635","\u0645"],void 0,["\u0635\u0628\u0627\u062D\u064B\u0627","\u0645\u0633\u0627\u0621\u064B"]],[["\u062D","\u0646","\u062B","\u0631","\u062E","\u062C","\u0633"],["\u0627\u0644\u0623\u062D\u062F","\u0627\u0644\u0627\u062B\u0646\u064A\u0646","\u0627\u0644\u062B\u0644\u0627\u062B\u0627\u0621","\u0627\u0644\u0623\u0631\u0628\u0639\u0627\u0621","\u0627\u0644\u062E\u0645\u064A\u0633","\u0627\u0644\u062C\u0645\u0639\u0629","\u0627\u0644\u0633\u0628\u062A"],void 0,["\u0623\u062D\u062F","\u0625\u062B\u0646\u064A\u0646","\u062B\u0644\u0627\u062B\u0627\u0621","\u0623\u0631\u0628\u0639\u0627\u0621","\u062E\u0645\u064A\u0633","\u062C\u0645\u0639\u0629","\u0633\u0628\u062A"]],void 0,[["\u064A","\u0641","\u0645","\u0623","\u0648","\u0646","\u0644","\u063A","\u0633","\u0643","\u0628","\u062F"],["\u064A\u0646\u0627\u064A\u0631","\u0641\u0628\u0631\u0627\u064A\u0631","\u0645\u0627\u0631\u0633","\u0623\u0628\u0631\u064A\u0644","\u0645\u0627\u064A\u0648","\u064A\u0648\u0646\u064A\u0648","\u064A\u0648\u0644\u064A\u0648","\u0623\u063A\u0633\u0637\u0633","\u0633\u0628\u062A\u0645\u0628\u0631","\u0623\u0643\u062A\u0648\u0628\u0631","\u0646\u0648\u0641\u0645\u0628\u0631","\u062F\u064A\u0633\u0645\u0628\u0631"],void 0],void 0,[["\u0642.\u0645","\u0645"],void 0,["\u0642\u0628\u0644 \u0627\u0644\u0645\u064A\u0644\u0627\u062F","\u0645\u064A\u0644\u0627\u062F\u064A"]],6,[5,6],["d\u200F/M\u200F/y","dd\u200F/MM\u200F/y","d MMMM y","EEEE\u060C d MMMM y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",void 0,"{1} \u0641\u064A {0}",void 0],[".",",",";","\u200E%\u200E","\u200E+","\u200E-","E","\xD7","\u2030","\u221E","\u0644\u064A\u0633\xA0\u0631\u0642\u0645\u064B\u0627",":"],["#,##0.###","#,##0%","\xA4\xA0#,##0.00","#E0"],"EGP","\u062C.\u0645.\u200F","\u062C\u0646\u064A\u0647 \u0645\u0635\u0631\u064A",{AED:["\u062F.\u0625.\u200F"],ARS:[void 0,"AR$"],AUD:["AU$"],BBD:[void 0,"BB$"],BHD:["\u062F.\u0628.\u200F"],BMD:[void 0,"BM$"],BND:[void 0,"BN$"],BSD:[void 0,"BS$"],BYN:[void 0,"\u0440."],BZD:[void 0,"BZ$"],CAD:["CA$"],CLP:[void 0,"CL$"],CNY:["CN\xA5"],COP:[void 0,"CO$"],CUP:[void 0,"CU$"],DOP:[void 0,"DO$"],DZD:["\u062F.\u062C.\u200F"],EGP:["\u062C.\u0645.\u200F","E\xA3"],FJD:[void 0,"FJ$"],GBP:["UK\xA3"],GYD:[void 0,"GY$"],HKD:["HK$"],IQD:["\u062F.\u0639.\u200F"],IRR:["\u0631.\u0625."],JMD:[void 0,"JM$"],JOD:["\u062F.\u0623.\u200F"],JPY:["JP\xA5"],KWD:["\u062F.\u0643.\u200F"],KYD:[void 0,"KY$"],LBP:["\u0644.\u0644.\u200F","L\xA3"],LRD:[void 0,"$LR"],LYD:["\u062F.\u0644.\u200F"],MAD:["\u062F.\u0645.\u200F"],MRU:["\u0623.\u0645."],MXN:["MX$"],NZD:["NZ$"],OMR:["\u0631.\u0639.\u200F"],PHP:[void 0,"\u20B1"],QAR:["\u0631.\u0642.\u200F"],SAR:["\u0631.\u0633.\u200F"],SBD:[void 0,"SB$"],SDD:["\u062F.\u0633.\u200F"],SDG:["\u062C.\u0633."],SRD:[void 0,"SR$"],SYP:["\u0644.\u0633.\u200F","\xA3"],THB:["\u0E3F"],TND:["\u062F.\u062A.\u200F"],TTD:[void 0,"TT$"],TWD:["NT$"],USD:["US$"],UYU:[void 0,"UY$"],YER:["\u0631.\u064A.\u200F"]},"rtl",Qt];je(it);var rt={providers:[Ne({eventCoalescing:!0}),$e(nt),{provide:Be,useValue:"ar"},Ye()]};var Ce=class o{constructor(i,e){this.el=i;this.router=e}ngOnInit(){this.el.nativeElement.classList.add("page-transition"),this.router.events.pipe(ae(i=>i instanceof se)).subscribe(()=>{this.el.nativeElement.classList.add("page-transition-active"),setTimeout(()=>{this.el.nativeElement.classList.remove("page-transition-active")},300)})}static \u0275fac=function(e){return new(e||o)(O(ke),O(D))};static \u0275dir=De({type:o,selectors:[["","appPageTransition",""]]})};function Zt(o,i){if(o&1){let e=P();t(0,"a",25),f("click",function(){m(e);let u=g(2);return p(u.closeSidebarOnMobile())}),t(1,"span",14),a(2,"\u{1F464}"),n(),t(3,"span"),a(4,"\u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645\u0648\u0646"),n()()}}function Xt(o,i){if(o&1){let e=P();t(0,"a",26),f("click",function(){m(e);let u=g(2);return p(u.closeSidebarOnMobile())}),t(1,"span",14),a(2,"\u{1F3E2}"),n(),t(3,"span"),a(4,"\u0627\u0644\u0641\u0631\u0648\u0639"),n()()}}function en(o,i){if(o&1){let e=P();t(0,"a",27),f("click",function(){m(e);let u=g(2);return p(u.closeSidebarOnMobile())}),t(1,"span",14),a(2,"\u{1F5C2}\uFE0F"),n(),t(3,"span"),a(4,"\u0623\u0646\u0648\u0627\u0639 \u0627\u0644\u062D\u0636\u0648\u0631"),n()()}}function tn(o,i){if(o&1){let e=P();t(0,"a",28),f("click",function(){m(e);let u=g(2);return p(u.closeSidebarOnMobile())}),t(1,"span",14),a(2,"\u23F0"),n(),t(3,"span"),a(4,"\u0627\u0644\u0648\u0631\u062F\u064A\u0627\u062A"),n()()}}function nn(o,i){if(o&1){let e=P();t(0,"a",29),f("click",function(){m(e);let u=g(2);return p(u.closeSidebarOnMobile())}),t(1,"span",14),a(2,"\u{1F4DD}"),n(),t(3,"span"),a(4,"\u0633\u062C\u0644\u0627\u062A \u0627\u0644\u062D\u0636\u0648\u0631"),n()()}}function rn(o,i){if(o&1){let e=P();t(0,"a",30),f("click",function(){m(e);let u=g(2);return p(u.closeSidebarOnMobile())}),t(1,"span",14),a(2,"\u{1F4B8}"),n(),t(3,"span"),a(4,"\u0627\u0644\u062E\u0635\u0648\u0645\u0627\u062A"),n()()}}function an(o,i){if(o&1){let e=P();t(0,"a",31),f("click",function(){m(e);let u=g(2);return p(u.closeSidebarOnMobile())}),t(1,"span",14),a(2,"\u{1F381}"),n(),t(3,"span"),a(4,"\u0627\u0644\u0645\u0643\u0627\u0641\u0626\u0627\u062A"),n()()}}function on(o,i){if(o&1){let e=P();t(0,"a",32),f("click",function(){m(e);let u=g(2);return p(u.closeSidebarOnMobile())}),t(1,"span",14),a(2,"\u{1F3F7}\uFE0F"),n(),t(3,"span"),a(4,"\u062D\u0627\u0644\u0627\u062A \u0627\u0644\u0637\u0644\u0628\u0627\u062A"),n()()}}function ln(o,i){if(o&1){let e=P();t(0,"div",33)(1,"div",34)(2,"span",14),a(3,"\u{1F4CA}"),n(),t(4,"span"),a(5,"\u0627\u0644\u062A\u0642\u0627\u0631\u064A\u0631"),n()(),t(6,"div",35)(7,"a",36),f("click",function(){m(e);let u=g(2);return p(u.closeSidebarOnMobile())}),t(8,"span"),a(9,"\u0627\u0644\u062A\u0642\u0627\u0631\u064A\u0631 \u0627\u0644\u0634\u0647\u0631\u064A\u0629"),n()(),t(10,"a",37),f("click",function(){m(e);let u=g(2);return p(u.closeSidebarOnMobile())}),t(11,"span"),a(12,"\u062D\u0627\u0633\u0628\u0629 \u0627\u0644\u0631\u0627\u062A\u0628 \u0627\u0644\u0641\u0648\u0631\u064A"),n()()()()}}function un(o,i){if(o&1){let e=P();t(0,"div",38)(1,"button",39),f("click",function(){m(e);let u=g(2);return p(u.logout())}),a(2,"\u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062E\u0631\u0648\u062C"),n()()}}function sn(o,i){if(o&1){let e=P();t(0,"aside",9)(1,"div",10),S(2,"img",11),t(3,"span"),a(4,"\u062F\u0642\u062F\u0642 \u0628\u0631\u062C\u0631"),n()(),t(5,"nav",12)(6,"a",13),f("click",function(){m(e);let u=g();return p(u.closeSidebarOnMobile())}),t(7,"span",14),a(8,"\u{1F3E0}"),n(),t(9,"span"),a(10,"\u0644\u0648\u062D\u0629 \u062A\u062D\u0643\u0645 \u062F\u0642\u062F\u0642 \u0628\u0631\u062C\u0631"),n()(),h(11,Zt,5,0,"a",15)(12,Xt,5,0,"a",16)(13,en,5,0,"a",17)(14,tn,5,0,"a",18)(15,nn,5,0,"a",19)(16,rn,5,0,"a",20)(17,an,5,0,"a",21)(18,on,5,0,"a",22)(19,ln,13,0,"div",23),n(),h(20,un,3,0,"div",24),n()}if(o&2){let e=g();E("open",e.sidebarOpen),l(11),d("ngIf",e.isLoggedIn()),l(),d("ngIf",e.isLoggedIn()),l(),d("ngIf",e.isLoggedIn()),l(),d("ngIf",e.isLoggedIn()),l(),d("ngIf",e.isLoggedIn()),l(),d("ngIf",e.isLoggedIn()),l(),d("ngIf",e.isLoggedIn()),l(),d("ngIf",e.isLoggedIn()),l(),d("ngIf",e.isLoggedIn()),l(),d("ngIf",e.isLoggedIn())}}function dn(o,i){o&1&&S(0,"app-spinner",40),o&2&&d("overlay",!0)}function cn(o,i){if(o&1){let e=P();t(0,"header",41)(1,"div",42)(2,"div",43)(3,"button",44),f("click",function(){m(e);let u=g();return p(u.toggleSidebar())}),a(4,"\u2630"),n(),t(5,"h1"),a(6,"\u0644\u0648\u062D\u0629 \u062A\u062D\u0643\u0645 \u062F\u0642\u062F\u0642 \u0628\u0631\u062C\u0631"),n()(),t(7,"div",45)(8,"div",46),S(9,"img",47),n()()()()}}var be=class o{constructor(i,e,r,u){this.sb=i;this.router=e;this.loadingService=r;this.flash=u;this.loading$=this.loadingService.loading$,this.checkIfLoginPage(this.router.url),this.router.events.pipe(ae(z=>z instanceof se)).subscribe(z=>{this.checkIfLoginPage(z.url)}),this.sb.sessionExpired$.subscribe(()=>{this.flash.set("\u0627\u0646\u062A\u0647\u062A \u0627\u0644\u062C\u0644\u0633\u0629 \u0644\u0623\u0633\u0628\u0627\u0628 \u0623\u0645\u0646\u064A\u0629. \u064A\u0631\u062C\u0649 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u062E\u0648\u0644 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649.","warning"),this.isLoginPage||this.router.navigateByUrl("/login")});let c=()=>this.sb.notifyActivity();["mousemove","keydown","click","scroll","touchstart"].forEach(z=>window.addEventListener(z,c,{passive:!0}))}title=Ae("attendance-admin");sidebarOpen=!1;loading$;isLoginPage=!1;checkIfLoginPage(i){this.isLoginPage=i.includes("/login")}isLoggedIn(){return this.sb.isLoggedIn()}logout(){this.loadingService.show(),this.sb.logout(),this.router.navigateByUrl("/login").then(()=>{this.loadingService.hide()})}toggleSidebar(){this.sidebarOpen=!this.sidebarOpen}closeSidebarOnMobile(){this.sidebarOpen=!1}static \u0275fac=function(e){return new(e||o)(O(A),O(D),O(ee),O(te))};static \u0275cmp=k({type:o,selectors:[["app-root"]],decls:11,vars:9,consts:[["dir","rtl",1,"app-shell"],["class","sidebar",3,"open",4,"ngIf"],[1,"main-area"],["message","\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644...",3,"overlay",4,"ngIf"],["class","topbar",4,"ngIf"],[1,"content"],[1,"container"],["appPageTransition",""],[1,"sidebar-overlay",3,"click"],[1,"sidebar"],[1,"brand"],["src","favicon.ico","alt","\u062F\u0642\u062F\u0642 \u0628\u0631\u062C\u0631","onerror","this.style.display='none'"],[1,"menu"],["routerLink","/dashboard","routerLinkActive","active",3,"click"],[1,"icon"],["routerLink","/users","routerLinkActive","active",3,"click",4,"ngIf"],["routerLink","/branches","routerLinkActive","active",3,"click",4,"ngIf"],["routerLink","/attendance-types","routerLinkActive","active",3,"click",4,"ngIf"],["routerLink","/shifts","routerLinkActive","active",3,"click",4,"ngIf"],["routerLink","/attendance-records","routerLinkActive","active",3,"click",4,"ngIf"],["routerLink","/deductions","routerLinkActive","active",3,"click",4,"ngIf"],["routerLink","/additions","routerLinkActive","active",3,"click",4,"ngIf"],["routerLink","/request-statuses","routerLinkActive","active",3,"click",4,"ngIf"],["class","menu-section",4,"ngIf"],["class","sidebar-footer",4,"ngIf"],["routerLink","/users","routerLinkActive","active",3,"click"],["routerLink","/branches","routerLinkActive","active",3,"click"],["routerLink","/attendance-types","routerLinkActive","active",3,"click"],["routerLink","/shifts","routerLinkActive","active",3,"click"],["routerLink","/attendance-records","routerLinkActive","active",3,"click"],["routerLink","/deductions","routerLinkActive","active",3,"click"],["routerLink","/additions","routerLinkActive","active",3,"click"],["routerLink","/request-statuses","routerLinkActive","active",3,"click"],[1,"menu-section"],[1,"menu-header"],[1,"submenu"],["routerLink","/reports/employee-monthly","routerLinkActive","active",3,"click"],["routerLink","/reports/instant-salary","routerLinkActive","active",3,"click"],[1,"sidebar-footer"],[1,"logout",3,"click"],["message","\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644...",3,"overlay"],[1,"topbar"],[1,"container","topbar-inner"],[1,"topbar-left"],["aria-label","menu",1,"menu-btn",3,"click"],[1,"topbar-right"],[1,"logo-container"],["src","favicon.ico","alt","\u062F\u0642\u062F\u0642 \u0628\u0631\u062C\u0631",1,"main-logo"]],template:function(e,r){e&1&&(t(0,"div",0),h(1,sn,21,12,"aside",1),t(2,"div",2),h(3,dn,1,1,"app-spinner",3),x(4,"async"),h(5,cn,10,0,"header",4),t(6,"main",5)(7,"div",6)(8,"div",7),S(9,"router-outlet"),n()()()(),t(10,"div",8),f("click",function(){return r.sidebarOpen=!1}),n()()),e&2&&(l(),d("ngIf",!r.isLoginPage),l(),E("full-width",r.isLoginPage),l(),d("ngIf",Re(4,7,r.loading$)),l(2),d("ngIf",!r.isLoginPage),l(5),E("show",r.sidebarOpen&&!r.isLoginPage))},dependencies:[Ge,He,Ke,I,X,Ce,ze],encapsulation:2})};Ue(be,rt).catch(o=>console.error(o));
